CVE Number : CVE-2010-4342
Commit Message : 
econet: Fix crash in aun_incoming().
Commit Details : 
Unconditional use of skb->dev won't work here,
try to fetch the econet device via skb_dst()->dev
instead.

Suggested by Eric Dumazet.

Reported-by: Nelson Elhage <nelhage@ksplice.com>
Tested-by: Nelson Elhage <nelhage@ksplice.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 {
 	struct iphdr *ip = ip_hdr(skb);
 	unsigned char stn = ntohl(ip >saddr) & 0xff;
 	struct sock *sk = NULL;
 	struct sk_buff *newskb;
 	struct ec_device *edev = skb >dev >ec_ptr;
 
 	if (! edev)
 		goto bad;
After patch : 
 {
 	struct iphdr *ip = ip_hdr(skb);
 	unsigned char stn = ntohl(ip >saddr) & 0xff;
 	struct dst_entry *dst = skb_dst(skb);
 	struct ec_device *edev = NULL;
 	struct sock *sk = NULL;
 	struct sk_buff *newskb;
 
 	if (dst)
 		edev = dst >dev >ec_ptr;
 
 	if (! edev)
 		goto bad;
