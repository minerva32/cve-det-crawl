CVE Number : CVE-2012-2137
Commit Message : 
KVM: Fix buffer overflow in kvm_set_irq()
Commit Details : 
kvm_set_irq() has an internal buffer of three irq routing entries, allowing
connecting a GSI to three IRQ chips or on MSI.  However setup_routing_entry()
does not properly enforce this, allowing three irqchip routes followed by
an MSI route to overflow the buffer.

Fix by ensuring that an MSI entry is added to an empty list.

Signed-off-by: Avi Kivity <avi@redhat.com>

Before patch : 
 	 */
 	hlist_for_each_entry(ei, n, &rt >map[ue >gsi], link)
 		if (ei >type == KVM_IRQ_ROUTING_MSI ||
 		    ue >u.irqchip.irqchip == ei >irqchip.irqchip)
 			return r;
 
After patch : 
 	 */
 	hlist_for_each_entry(ei, n, &rt >map[ue >gsi], link)
 		if (ei >type == KVM_IRQ_ROUTING_MSI ||
 		    ue >type == KVM_IRQ_ROUTING_MSI ||
 		    ue >u.irqchip.irqchip == ei >irqchip.irqchip)
 			return r;
 
