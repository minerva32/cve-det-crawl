CVE Number : CVE-2012-6657
Commit Message : 
net: guard tcp_set_keepalive() to tcp sockets
Commit Details : 
Its possible to use RAW sockets to get a crash in
tcp_set_keepalive() / sk_reset_timer()

Fix is to make sure socket is a SOCK_STREAM one.

Reported-by: Dave Jones <davej@redhat.com>
Signed-off-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 
 	case SO_KEEPALIVE:
 #ifdef CONFIG_INET
 		if (sk >sk_protocol == IPPROTO_TCP)
 			tcp_set_keepalive(sk, valbool);
 #endif
 		sock_valbool_flag(sk, SOCK_KEEPOPEN, valbool);
After patch : 
 
 	case SO_KEEPALIVE:
 #ifdef CONFIG_INET
 		if (sk >sk_protocol == IPPROTO_TCP &&
 		    sk >sk_type == SOCK_STREAM)
 			tcp_set_keepalive(sk, valbool);
 #endif
 		sock_valbool_flag(sk, SOCK_KEEPOPEN, valbool);
