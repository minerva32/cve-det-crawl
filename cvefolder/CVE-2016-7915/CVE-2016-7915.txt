CVE Number : CVE-2016-7915
Commit Message : 
HID: core: prevent out-of-bound readings
Commit Details : 
Plugging a Logitech DJ receiver with KASAN activated raises a bunch of
out-of-bound readings.

The fields are allocated up to MAX_USAGE, meaning that potentially, we do
not have enough fields to fit the incoming values.
Add checks and silence KASAN.

Signed-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
Signed-off-by: Jiri Kosina <jkosina@suse.cz>

Before patch : 
 		/* Ignore report if ErrorRollOver */
 		if (!(field >flags & HID_MAIN_ITEM_VARIABLE) &&
 		    value[n] >= min && value[n] <= max &&
 		    field >usage[value[n]   min].hid == HID_UP_KEYBOARD   1)
 			goto exit;
 	}
 		}
 
 		if (field >value[n] >= min && field >value[n] <= max
 			&& field >usage[field >value[n]   min].hid
 			&& search(value, field >value[n], count))
 				hid_process_event(hid, field, &field >usage[field >value[n]   min], 0, interrupt);
 
 		if (value[n] >= min && value[n] <= max
 			&& field >usage[value[n]   min].hid
 			&& search(field >value, value[n], count))
 				hid_process_event(hid, field, &field >usage[value[n]   min], 1, interrupt);
After patch : 
 		/* Ignore report if ErrorRollOver */
 		if (!(field >flags & HID_MAIN_ITEM_VARIABLE) &&
 		    value[n] >= min && value[n] <= max &&
 		    value[n]   min < field >maxusage &&
 		    field >usage[value[n]   min].hid == HID_UP_KEYBOARD   1)
 			goto exit;
 	}
 		}
 
 		if (field >value[n] >= min && field >value[n] <= max
 			&& field >value[n]   min < field >maxusage
 			&& field >usage[field >value[n]   min].hid
 			&& search(value, field >value[n], count))
 				hid_process_event(hid, field, &field >usage[field >value[n]   min], 0, interrupt);
 
 		if (value[n] >= min && value[n] <= max
 			&& value[n]   min < field >maxusage
 			&& field >usage[value[n]   min].hid
 			&& search(field >value, value[n], count))
 				hid_process_event(hid, field, &field >usage[value[n]   min], 1, interrupt);
