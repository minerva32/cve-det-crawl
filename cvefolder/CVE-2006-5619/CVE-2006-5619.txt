CVE Number : CVE-2006-5619
Commit Message : 
IPV6: fix lockup via /proc/net/ip6_flowlabel
Commit Details : 
There's a bug in the seqfile handling for /proc/net/ip6_flowlabel, where,
after finding a flowlabel, the code will loop forever not finding any
further flowlabels, first traversing the rest of the hash bucket then just
looping.

This patch fixes the problem by breaking after the hash bucket has been
traversed.

Note that this bug can cause lockups and oopses, and is trivially invoked
by an unpriveleged user.

Signed-off-by: James Morris <jmorris@namei.org>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	while (!fl) {
 		if (  state >bucket <= FL_HASH_MASK)
 			fl = fl_ht[state >bucket];
 	}
 	return fl;
 }
After patch : 
 	while (!fl) {
 		if (  state >bucket <= FL_HASH_MASK)
 			fl = fl_ht[state >bucket];
 		else
 			break;
 	}
 	return fl;
 }
