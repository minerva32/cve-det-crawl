CVE Number : CVE-2011-1598
Commit Message : 
can: Add missing socket check in can/bcm release.
Commit Details : 
We can get here with a NULL socket argument passed from userspace,
so we need to handle it accordingly.

Signed-off-by: Dave Jones <davej@redhat.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 static int bcm_release(struct socket *sock)
 {
 	struct sock *sk = sock >sk;
 	struct bcm_sock *bo = bcm_sk(sk);
 	struct bcm_op *op, *next;
 
 	/* remove bcm_ops, timer, rx_unregister(), etc. */
 
 	unregister_netdevice_notifier(&bo >notifier);
After patch : 
 static int bcm_release(struct socket *sock)
 {
 	struct sock *sk = sock >sk;
 	struct bcm_sock *bo;
 	struct bcm_op *op, *next;
 
 	if (sk == NULL)
 		return 0;
 
 	bo = bcm_sk(sk);
 
 	/* remove bcm_ops, timer, rx_unregister(), etc. */
 
 	unregister_netdevice_notifier(&bo >notifier);
