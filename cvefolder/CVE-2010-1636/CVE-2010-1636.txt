CVE Number : CVE-2010-1636
Commit Message : 
Btrfs: check for read permission on src file in the clone ioctl
Commit Details : 
The existing code would have allowed you to clone a file that was
only open for writing

Signed-off-by: Chris Mason <chris.mason@oracle.com>

Before patch : 
 		ret =  EBADF;
 		goto out_drop_write;
 	}
 	src = src_file >f_dentry >d_inode;
 
 	ret =  EINVAL;
 	if (src == inode)
 		goto out_fput;
 
 	ret =  EISDIR;
 	if (S_ISDIR(src >i_mode) || S_ISDIR(inode >i_mode))
 		goto out_fput;
After patch : 
 		ret =  EBADF;
 		goto out_drop_write;
 	}
 
 	src = src_file >f_dentry >d_inode;
 
 	ret =  EINVAL;
 	if (src == inode)
 		goto out_fput;
 
 	/* the src must be open for reading */
 	if (!(src_file >f_mode & FMODE_READ))
 		goto out_fput;
 
 	ret =  EISDIR;
 	if (S_ISDIR(src >i_mode) || S_ISDIR(inode >i_mode))
 		goto out_fput;
