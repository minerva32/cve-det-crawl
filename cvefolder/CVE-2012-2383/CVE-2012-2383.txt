CVE Number : CVE-2012-2383
Commit Message : 
drm/i915: fix integer overflow in i915_gem_execbuffer2()
Commit Details : 
On 32-bit systems, a large args->buffer_count from userspace via ioctl
may overflow the allocation size, leading to out-of-bounds access.

This vulnerability was introduced in commit 8408c282 ("drm/i915:
First try a normal large kmalloc for the temporary exec buffers").

Signed-off-by: Xi Wang <xi.wang@gmail.com>
Reviewed-by: Chris Wilson <chris@chris-wilson.co.uk>
Cc: stable@vger.kernel.org
Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

Before patch : 
 	struct drm_i915_gem_exec_object2 *exec2_list = NULL;
 	int ret;
 
 	if (args >buffer_count < 1) {
 		DRM_DEBUG("execbuf2 with %d buffers\n", args >buffer_count);
 		return  EINVAL;
 	}
After patch : 
 	struct drm_i915_gem_exec_object2 *exec2_list = NULL;
 	int ret;
 
 	if (args >buffer_count < 1 ||
 	    args >buffer_count > UINT_MAX / sizeof(*exec2_list)) {
 		DRM_DEBUG("execbuf2 with %d buffers\n", args >buffer_count);
 		return  EINVAL;
 	}
