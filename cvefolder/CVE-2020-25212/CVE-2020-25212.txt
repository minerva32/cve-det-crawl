CVE Number : CVE-2020-25212
Commit Message : 
nfs: Fix getxattr kernel panic and memory overflow
Commit Details : 
Move the buffer size check to decode_attr_security_label() before memcpy()
Only call memcpy() if the buffer is large enough

Fixes: aa9c2669626c ("NFS: Client implementation of Labeled-NFS")
Signed-off-by: Jeffrey Mitchell <jeffrey.mitchell@starlab.io>
Trond: clean up duplicate test of label->len != 0
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>

Before patch : 
 		return ret;
 	if (!(fattr.valid & NFS_ATTR_FATTR_V4_SECURITY_LABEL))
 		return  ENOENT;
 	if (buflen < label.len)
 		return  ERANGE;
 	return 0;
 }
 
 			return  EIO;
 		if (len < NFS4_MAXLABELLEN) {
 			if (label) {
 				memcpy(label >label, p, len);
 				label >len = len;
 				label >pi = pi;
 				label >lfs = lfs;
After patch : 
 		return ret;
 	if (!(fattr.valid & NFS_ATTR_FATTR_V4_SECURITY_LABEL))
 		return  ENOENT;
 	return 0;
 }
 
 			return  EIO;
 		if (len < NFS4_MAXLABELLEN) {
 			if (label) {
 				if (label >len) {
 					if (label >len < len)
 						return  ERANGE;
 					memcpy(label >label, p, len);
 				}
 				label >len = len;
 				label >pi = pi;
 				label >lfs = lfs;
