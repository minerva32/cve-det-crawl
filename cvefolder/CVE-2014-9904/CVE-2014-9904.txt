CVE Number : CVE-2014-9904
Commit Message : 
ALSA: compress: fix an integer overflow check
Commit Details : 
I previously added an integer overflow check here but looking at it now,
it's still buggy.

The bug happens in snd_compr_allocate_buffer().  We multiply
".fragments" and ".fragment_size" and that doesn't overflow but then we
save it in an unsigned int so it truncates the high bits away and we
allocate a smaller than expected size.

Fixes: b35cc8225845 ('ALSA: compress_core: integer overflow in snd_compr_allocate_buffer()')
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

Before patch : 
 {
 	/* first let's check the buffer parameter's */
 	if (params >buffer.fragment_size == 0 ||
 			params >buffer.fragments > SIZE_MAX / params >buffer.fragment_size)
 		return  EINVAL;
 
 	/* now codec parameters */
After patch : 
 {
 	/* first let's check the buffer parameter's */
 	if (params >buffer.fragment_size == 0 ||
 	    params >buffer.fragments > INT_MAX / params >buffer.fragment_size)
 		return  EINVAL;
 
 	/* now codec parameters */
