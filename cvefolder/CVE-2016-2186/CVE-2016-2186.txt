CVE Number : CVE-2016-2186
Commit Message : 
Input: powermate - fix oops with malicious USB descriptors
Commit Details : 
The powermate driver expects at least one valid USB endpoint in its
probe function.  If given malicious descriptors that specify 0 for
the number of endpoints, it will crash.  Validate the number of
endpoints on the interface before using them.

The full report for this issue can be found here:
http://seclists.org/bugtraq/2016/Mar/85

Reported-by: Ralf Spenneberg <ralf@spenneberg.net>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Josh Boyer <jwboyer@fedoraproject.org>
Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
Before patch : 
 	int error =  ENOMEM;
 
 	interface = intf >cur_altsetting;
 	endpoint = &interface >endpoint[0].desc;
 	if (!usb_endpoint_is_int_in(endpoint))
 		return  EIO;
After patch : 
 	int error =  ENOMEM;
 
 	interface = intf >cur_altsetting;
 	if (interface >desc.bNumEndpoints < 1)
 		return  EINVAL;
 
 	endpoint = &interface >endpoint[0].desc;
 	if (!usb_endpoint_is_int_in(endpoint))
 		return  EIO;
