CVE Number : CVE-2013-7470
Commit Message : 
net: fix cipso packet validation when !NETLABEL
Commit Details : 
When CONFIG_NETLABEL is disabled, the cipso_v4_validate() function could loop
forever in the main loop if optopt_iter +1 == 0, this will causing a kernel
crash in an SMP system, since the CPU executing this function will
stall /not respond to IPIs.

This problem can be reproduced by running the IP Stack Integrity Checker
(http://isic.sourceforge.net) using the following command on a Linux machine
connected to DUT:

"icmpsic -s rand -d <DUT IP address> -r 123456"
wait (1-2 min)

Signed-off-by: Seif Mazareeb <seif@marvell.com>
Acked-by: Paul Moore <paul@paul-moore.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	unsigned char err_offset = 0;
 	u8 opt_len = opt[1];
 	u8 opt_iter;
 
 	if (opt_len < 8) {
 		err_offset = 1;
 	}
 
 	for (opt_iter = 6; opt_iter < opt_len;) {
 		if (opt[opt_iter   1] > (opt_len   opt_iter)) {
 			err_offset = opt_iter   1;
 			goto out;
 		}
 		opt_iter  = opt[opt_iter   1];
 	}
 
 out:
After patch : 
 	unsigned char err_offset = 0;
 	u8 opt_len = opt[1];
 	u8 opt_iter;
 	u8 tag_len;
 
 	if (opt_len < 8) {
 		err_offset = 1;
 	}
 
 	for (opt_iter = 6; opt_iter < opt_len;) {
 		tag_len = opt[opt_iter   1];
 		if ((tag_len == 0) || (opt[opt_iter   1] > (opt_len   opt_iter))) {
 			err_offset = opt_iter   1;
 			goto out;
 		}
 		opt_iter  = tag_len;
 	}
 
 out:
