CVE Number : CVE-2012-6638
Commit Message : 
tcp: drop SYN+FIN messages
Commit Details : 
Denys Fedoryshchenko reported that SYN+FIN attacks were bringing his
linux machines to their limits.

Dont call conn_request() if the TCP flags includes SYN flag

Reported-by: Denys Fedoryshchenko <denys@visp.net.lb>
Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 			goto discard;
 
 		if (th >syn) {
 			if (icsk >icsk_af_ops >conn_request(sk, skb) < 0)
 				return 1;
 
After patch : 
 			goto discard;
 
 		if (th >syn) {
 			if (th >fin)
 				goto discard;
 			if (icsk >icsk_af_ops >conn_request(sk, skb) < 0)
 				return 1;
 
