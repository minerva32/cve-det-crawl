CVE Number : CVE-2013-6380
Commit Message : 
aacraid: prevent invalid pointer dereference
Commit Details : 
It appears that driver runs into a problem here if fibsize is too small
because we allocate user_srbcmd with fibsize size only but later we
access it until user_srbcmd->sg.count to copy it over to srbcmd.

It is not correct to test (fibsize < sizeof(*user_srbcmd)) because this
structure already includes one sg element and this is not needed for
commands without data.  So, we would recommend to add the following
(instead of test for fibsize == 0).

Signed-off-by: Mahesh Rajashekhara <Mahesh.Rajashekhara@pmcs.com>
Reported-by: Nico Golde <nico@ngolde.de>
Reported-by: Fabian Yamaguchi <fabs@goesec.de>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 		goto cleanup;
 	}
 
 	if (fibsize > (dev >max_fib_size   sizeof(struct aac_fibhdr))) {
 		rcode =  EINVAL;
 		goto cleanup;
 	}
After patch : 
 		goto cleanup;
 	}
 
 	if ((fibsize < (sizeof(struct user_aac_srb)   sizeof(struct user_sgentry))) ||
 	    (fibsize > (dev >max_fib_size   sizeof(struct aac_fibhdr)))) {
 		rcode =  EINVAL;
 		goto cleanup;
 	}
