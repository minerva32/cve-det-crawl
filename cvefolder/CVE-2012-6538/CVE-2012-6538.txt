CVE Number : CVE-2012-6538
Commit Message : 
xfrm_user: fix info leak in copy_to_user_auth()
Commit Details : 
copy_to_user_auth() fails to initialize the remainder of alg_name and
therefore discloses up to 54 bytes of heap memory via netlink to
userland.

Use strncpy() instead of strcpy() to fill the trailing bytes of alg_name
with null bytes.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Acked-by: Steffen Klassert <steffen.klassert@secunet.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 		return  EMSGSIZE;
 
 	algo = nla_data(nla);
 	strcpy(algo >alg_name, auth >alg_name);
 	memcpy(algo >alg_key, auth >alg_key, (auth >alg_key_len   7) / 8);
 	algo >alg_key_len = auth >alg_key_len;
 
After patch : 
 		return  EMSGSIZE;
 
 	algo = nla_data(nla);
 	strncpy(algo >alg_name, auth >alg_name, sizeof(algo >alg_name));
 	memcpy(algo >alg_key, auth >alg_key, (auth >alg_key_len   7) / 8);
 	algo >alg_key_len = auth >alg_key_len;
 
