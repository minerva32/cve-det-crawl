CVE Number : CVE-2020-15780
Commit Message : 
ACPI: configfs: Disallow loading ACPI tables when locked down
Commit Details : 
Like other vectors already patched, this one here allows the root
user to load ACPI tables, which enables arbitrary physical address
writes, which in turn makes it possible to disable lockdown.

Prevents this by checking the lockdown status before allowing a new
ACPI table to be installed. The link in the trailer shows a PoC of
how this might be used.

Link: https://git.zx2c4.com/american-unsigned-language/tree/american-unsigned-language-2.sh
Cc: 5.4+ <stable@vger.kernel.org> # 5.4+
Signed-off-by: Jason A. Donenfeld <Jason@zx2c4.com>
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

Before patch : 
 #include <linux/module.h>
 #include <linux/configfs.h>
 #include <linux/acpi.h>
 
 #include "acpica/accommon.h"
 #include "acpica/actables.h"
 {
 	const struct acpi_table_header *header = data;
 	struct acpi_table *table;
 	int ret;
 
 	table = container_of(cfg, struct acpi_table, cfg);
 
After patch : 
 #include <linux/module.h>
 #include <linux/configfs.h>
 #include <linux/acpi.h>
 #include <linux/security.h>
 
 #include "acpica/accommon.h"
 #include "acpica/actables.h"
 {
 	const struct acpi_table_header *header = data;
 	struct acpi_table *table;
 	int ret = security_locked_down(LOCKDOWN_ACPI_TABLES);
 
 	if (ret)
 		return ret;
 
 	table = container_of(cfg, struct acpi_table, cfg);
 
