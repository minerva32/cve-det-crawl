CVE Number : CVE-2011-4087
Commit Message : 
bridge: reset IPCB in br_parse_ip_options
Commit Details : 
Commit 462fb2af9788a82 (bridge : Sanitize skb before it enters the IP
stack), missed one IPCB init before calling ip_options_compile()

Thanks to Scot Doyle for his tests and bug reports.

Reported-by: Scot Doyle <lkml@scotdoyle.com>
Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
Cc: Hiroaki SHIMODA <shimoda.hiroaki@gmail.com>
Acked-by: Bandan Das <bandan.das@stratus.com>
Acked-by: Stephen Hemminger <shemminger@vyatta.com>
Cc: Jan LÃ¼bbe <jluebbe@debian.org>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 		goto drop;
 	}
 
 	/* Zero out the CB buffer if no options present */
 	if (iph >ihl == 5) {
 		memset(IPCB(skb), 0, sizeof(struct inet_skb_parm));
 		return 0;
 	}
 
 	opt >optlen = iph >ihl*4   sizeof(struct iphdr);
 	if (ip_options_compile(dev_net(dev), opt, skb))
After patch : 
 		goto drop;
 	}
 
 	memset(IPCB(skb), 0, sizeof(struct inet_skb_parm));
 	if (iph >ihl == 5)
 		return 0;
 
 	opt >optlen = iph >ihl*4   sizeof(struct iphdr);
 	if (ip_options_compile(dev_net(dev), opt, skb))
