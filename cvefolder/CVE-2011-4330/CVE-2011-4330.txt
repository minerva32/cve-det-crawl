CVE Number : CVE-2011-4330
Commit Message : 
hfs: add sanity check for file name length
Commit Details : 
On a corrupted file system the ->len field could be wrong leading to
a buffer overflow.

Reported-and-acked-by: Clement LECIGNE <clement.lecigne@netasq.com>
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Cc: stable@kernel.org
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 
 	src = in >name;
 	srclen = in >len;
 	dst = out;
 	dstlen = HFS_MAX_NAMELEN;
 	if (nls_io) {
After patch : 
 
 	src = in >name;
 	srclen = in >len;
 	if (srclen > HFS_NAMELEN)
 		srclen = HFS_NAMELEN;
 	dst = out;
 	dstlen = HFS_MAX_NAMELEN;
 	if (nls_io) {
