CVE Number : CVE-2014-9729
Commit Message : 
udf: Verify i_size when loading inode
Commit Details : 
Verify that inode size is sane when loading inode with data stored in
ICB. Otherwise we may get confused later when working with the inode and
inode size is too big.

CC: stable@vger.kernel.org
Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no>
Signed-off-by: Jan Kara <jack@suse.cz>

Before patch : 
 	}
 	inode >i_generation = iinfo >i_unique;
 
 	switch (fe >icbTag.fileType) {
 	case ICBTAG_FILE_TYPE_DIRECTORY:
 		inode >i_op = &udf_dir_inode_operations;
After patch : 
 	}
 	inode >i_generation = iinfo >i_unique;
 
 	/* Sanity checks for files in ICB so that we don't get confused later */
 	if (iinfo >i_alloc_type == ICBTAG_FLAG_AD_IN_ICB) {
 		/*
 		 * For file in ICB data is stored in allocation descriptor
 		 * so sizes should match
 		 */
 		if (iinfo >i_lenAlloc != inode >i_size)
 			goto out;
 		/* File in ICB has to fit in there... */
 		if (inode >i_size > inode >i_sb >s_blocksize  
 					udf_file_entry_alloc_offset(inode))
 			goto out;
 	}
 
 	switch (fe >icbTag.fileType) {
 	case ICBTAG_FILE_TYPE_DIRECTORY:
 		inode >i_op = &udf_dir_inode_operations;
