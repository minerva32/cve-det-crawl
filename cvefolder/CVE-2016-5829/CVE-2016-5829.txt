CVE Number : CVE-2016-5829
Commit Message : 
HID: hiddev: validate num_values for HIDIOCGUSAGES, HIDIOCSUSAGES commands
Commit Details : 
This patch validates the num_values parameter from userland during the
HIDIOCGUSAGES and HIDIOCSUSAGES commands. Previously, if the report id was set
to HID_REPORT_ID_UNKNOWN, we would fail to validate the num_values parameter
leading to a heap overflow.

Cc: stable@vger.kernel.org
Signed-off-by: Scott Bauer <sbauer@plzdonthack.me>
Signed-off-by: Jiri Kosina <jkosina@suse.cz>

Before patch : 
 					goto inval;
 			} else if (uref >usage_index >= field >report_count)
 				goto inval;
 
 			else if ((cmd == HIDIOCGUSAGES || cmd == HIDIOCSUSAGES) &&
 				 (uref_multi >num_values > HID_MAX_MULTI_USAGES ||
 				  uref >usage_index   uref_multi >num_values > field >report_count))
 				goto inval;
 		}
 
 		switch (cmd) {
 		case HIDIOCGUSAGE:
 			uref >value = field >value[uref >usage_index];
After patch : 
 					goto inval;
 			} else if (uref >usage_index >= field >report_count)
 				goto inval;
 		}
 
 		if ((cmd == HIDIOCGUSAGES || cmd == HIDIOCSUSAGES) &&
 		    (uref_multi >num_values > HID_MAX_MULTI_USAGES ||
 		     uref >usage_index   uref_multi >num_values > field >report_count))
 			goto inval;
 
 		switch (cmd) {
 		case HIDIOCGUSAGE:
 			uref >value = field >value[uref >usage_index];
