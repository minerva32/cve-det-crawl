CVE Number : CVE-2016-3137
Commit Message : 
USB: cypress_m8: add endpoint sanity check
Commit Details : 
An attack using missing endpoints exists.

CVE-2016-3137

Signed-off-by: Oliver Neukum <ONeukum@suse.com>
CC: stable@vger.kernel.org
Signed-off-by: Johan Hovold <johan@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

Before patch : 
 	struct usb_serial *serial = port >serial;
 	struct cypress_private *priv;
 
 	priv = kzalloc(sizeof(struct cypress_private), GFP_KERNEL);
 	if (!priv)
 		return  ENOMEM;
 		cypress_set_termios(tty, port, &priv >tmp_termios);
 
 	/* setup the port and start reading from the device */
 	if (!port >interrupt_in_urb) {
 		dev_err(&port >dev, "%s   interrupt_in_urb is empty!\n",
 			__func__);
 		return  1;
 	}
 
 	usb_fill_int_urb(port >interrupt_in_urb, serial >dev,
 		usb_rcvintpipe(serial >dev, port >interrupt_in_endpointAddress),
 		port >interrupt_in_urb >transfer_buffer,
After patch : 
 	struct usb_serial *serial = port >serial;
 	struct cypress_private *priv;
 
 	if (!port >interrupt_out_urb || !port >interrupt_in_urb) {
 		dev_err(&port >dev, "required endpoint is missing\n");
 		return  ENODEV;
 	}
 
 	priv = kzalloc(sizeof(struct cypress_private), GFP_KERNEL);
 	if (!priv)
 		return  ENOMEM;
 		cypress_set_termios(tty, port, &priv >tmp_termios);
 
 	/* setup the port and start reading from the device */
 	usb_fill_int_urb(port >interrupt_in_urb, serial >dev,
 		usb_rcvintpipe(serial >dev, port >interrupt_in_endpointAddress),
 		port >interrupt_in_urb >transfer_buffer,
