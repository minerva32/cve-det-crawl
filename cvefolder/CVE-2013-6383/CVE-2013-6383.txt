CVE Number : CVE-2013-6383
Commit Message : 
aacraid: missing capable() check in compat ioctl
Commit Details : 
In commit d496f94d22d1 ('SCSI aacraid: fix security weakness') we
added a check on CAP_SYS_RAWIO to the ioctl.  The compat ioctls need the
check as well.

Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Cc: stable@kernel.org
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 static int aac_compat_ioctl(struct scsi_device *sdev, int cmd, void __user *arg)
 {
 	struct aac_dev *dev = (struct aac_dev *)sdev >host >hostdata;
 	return aac_compat_do_ioctl(dev, cmd, (unsigned long)arg);
 }
 
After patch : 
 static int aac_compat_ioctl(struct scsi_device *sdev, int cmd, void __user *arg)
 {
 	struct aac_dev *dev = (struct aac_dev *)sdev >host >hostdata;
 	if (!capable(CAP_SYS_RAWIO))
 		return  EPERM;
 	return aac_compat_do_ioctl(dev, cmd, (unsigned long)arg);
 }
 
