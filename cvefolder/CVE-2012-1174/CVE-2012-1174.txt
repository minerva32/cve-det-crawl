CVE Number : CVE-2012-1174
Commit Message : 
util: never follow symlinks in rm_rf_children()
Commit Details : 
The function checks if the entry is a directory before recursing, but
there is a window between the check and the open, during which the
directory could be replaced with a symlink.

CVE-2012-1174
https://bugzilla.redhat.com/show_bug.cgi?id=803358

Before patch : 
                 if (is_dir) {
                         int subdir_fd;
 
                         if ((subdir_fd = openat(fd, de >d_name, O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC)) < 0) {
                                 if (ret == 0 && errno != ENOENT)
                                         ret =  errno;
                                 continue;
After patch : 
                 if (is_dir) {
                         int subdir_fd;
 
                         subdir_fd = openat(fd, de >d_name, O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC|O_NOFOLLOW);
                         if (subdir_fd < 0) {
                                 if (ret == 0 && errno != ENOENT)
                                         ret =  errno;
                                 continue;
