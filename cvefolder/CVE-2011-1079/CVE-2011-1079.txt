CVE Number : CVE-2011-1079
Commit Message : 
Bluetooth: bnep: fix buffer overflow
Commit Details : 
Struct ca is copied from userspace.  It is not checked whether the "device"
field is NULL terminated.  This potentially leads to BUG() inside of
alloc_netdev_mqs() and/or information leak by creating a device with a name
made of contents of kernel stack.

Signed-off-by: Vasiliy Kulikov <segoon@openwall.com>
Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>

Before patch : 
 			sockfd_put(nsock);
 			return  EBADFD;
 		}
 
 		err = bnep_add_connection(&ca, nsock);
 		if (!err) {
After patch : 
 			sockfd_put(nsock);
 			return  EBADFD;
 		}
 		ca.device[sizeof(ca.device) 1] = 0;
 
 		err = bnep_add_connection(&ca, nsock);
 		if (!err) {
