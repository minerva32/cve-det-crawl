CVE Number : CVE-2013-1796
Commit Message : 
KVM: x86: fix for buffer overflow in handling of MSR_KVM_SYSTEM_TIME (CVE-2013-1796)
Commit Details : 
If the guest sets the GPA of the time_page so that the request to update the
time straddles a page then KVM will write onto an incorrect page.  The
write is done byusing kmap atomic to get a pointer to the page for the time
structure and then performing a memcpy to that page starting at an offset
that the guest controls.  Well behaved guests always provide a 32-byte aligned
address, however a malicious guest could use this to corrupt host kernel
memory.

Tested: Tested against kvmclock unit test.

Signed-off-by: Andrew Honig <ahonig@google.com>
Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>

Before patch : 
 		/* ...but clean it before doing the actual write */
 		vcpu >arch.time_offset = data & ~(PAGE_MASK | 1);
 
 		vcpu >arch.time_page =
 				gfn_to_page(vcpu >kvm, data >> PAGE_SHIFT);
 
After patch : 
 		/* ...but clean it before doing the actual write */
 		vcpu >arch.time_offset = data & ~(PAGE_MASK | 1);
 
 		/* Check that the address is 32 byte aligned. */
 		if (vcpu >arch.time_offset &
 				(sizeof(struct pvclock_vcpu_time_info)   1))
 			break;
 
 		vcpu >arch.time_page =
 				gfn_to_page(vcpu >kvm, data >> PAGE_SHIFT);
 
