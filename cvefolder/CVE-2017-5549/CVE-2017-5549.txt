CVE Number : CVE-2017-5549
Commit Message : 
USB: serial: kl5kusb105: fix line-state error handling
Commit Details : 
The current implementation failed to detect short transfers when
attempting to read the line state, and also, to make things worse,
logged the content of the uninitialised heap transfer buffer.

Fixes: abf492e7b3ae ("USB: kl5kusb105: fix DMA buffers on stack")
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Cc: stable <stable@vger.kernel.org>
Reviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Johan Hovold <johan@kernel.org>

Before patch : 
 			     status_buf, KLSI_STATUSBUF_LEN,
 			     10000
 			     );
 	if (rc < 0)
 		dev_err(&port >dev, "Reading line status failed (error = %d)\n",
 			rc);
 	else {
 		status = get_unaligned_le16(status_buf);
 
 		dev_info(&port >serial >dev >dev, "read status %x %x\n",
After patch : 
 			     status_buf, KLSI_STATUSBUF_LEN,
 			     10000
 			     );
 	if (rc != KLSI_STATUSBUF_LEN) {
 		dev_err(&port >dev, "reading line status failed: %d\n", rc);
 		if (rc >= 0)
 			rc =  EIO;
 	} else {
 		status = get_unaligned_le16(status_buf);
 
 		dev_info(&port >serial >dev >dev, "read status %x %x\n",
