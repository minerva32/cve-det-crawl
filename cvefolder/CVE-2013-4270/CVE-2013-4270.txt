CVE Number : CVE-2013-4270
Commit Message : 
net: Update the sysctl permissions handler to test effective uid/gid
Commit Details : 
Modify the code to use current_euid(), and in_egroup_p, as in done
in fs/proc/proc_sysctl.c:test_perm()

Cc: stable@vger.kernel.org
Reviewed-by: Eric Sandeen <sandeen@redhat.com>
Reported-by: Eric Sandeen <sandeen@redhat.com>
Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 
 	/* Allow network administrator to have same access as root. */
 	if (ns_capable(net >user_ns, CAP_NET_ADMIN) ||
 	    uid_eq(root_uid, current_uid())) {
 		int mode = (table >mode >> 6) & 7;
 		return (mode << 6) | (mode << 3) | mode;
 	}
 	/* Allow netns root group to have the same access as the root group */
 	if (gid_eq(root_gid, current_gid())) {
 		int mode = (table >mode >> 3) & 7;
 		return (mode << 3) | mode;
 	}
After patch : 
 
 	/* Allow network administrator to have same access as root. */
 	if (ns_capable(net >user_ns, CAP_NET_ADMIN) ||
 	    uid_eq(root_uid, current_euid())) {
 		int mode = (table >mode >> 6) & 7;
 		return (mode << 6) | (mode << 3) | mode;
 	}
 	/* Allow netns root group to have the same access as the root group */
 	if (in_egroup_p(root_gid)) {
 		int mode = (table >mode >> 3) & 7;
 		return (mode << 3) | mode;
 	}
