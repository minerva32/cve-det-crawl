CVE Number : CVE-2019-9857
Commit Message : 
inotify: Fix fsnotify_mark refcount leak in inotify_update_existing_watch()
Commit Details : 
Commit 4d97f7d53da7dc83 ("inotify: Add flag IN_MASK_CREATE for
inotify_add_watch()") forgot to call fsnotify_put_mark() with
IN_MASK_CREATE after fsnotify_find_mark()

Fixes: 4d97f7d53da7dc83 ("inotify: Add flag IN_MASK_CREATE for inotify_add_watch()")
Signed-off-by: ZhangXiaoxu <zhangxiaoxu5@huawei.com>
Signed-off-by: Jan Kara <jack@suse.cz>

Before patch : 
 	fsn_mark = fsnotify_find_mark(&inode >i_fsnotify_marks, group);
 	if (!fsn_mark)
 		return  ENOENT;
 	else if (create)
 		return  EEXIST;
 
 	i_mark = container_of(fsn_mark, struct inotify_inode_mark, fsn_mark);
 
 	/* return the wd */
 	ret = i_mark >wd;
 
 	/* match the get from fsnotify_find_mark() */
 	fsnotify_put_mark(fsn_mark);
 
After patch : 
 	fsn_mark = fsnotify_find_mark(&inode >i_fsnotify_marks, group);
 	if (!fsn_mark)
 		return  ENOENT;
 	else if (create) {
 		ret =  EEXIST;
 		goto out;
 	}
 
 	i_mark = container_of(fsn_mark, struct inotify_inode_mark, fsn_mark);
 
 	/* return the wd */
 	ret = i_mark >wd;
 
 out:
 	/* match the get from fsnotify_find_mark() */
 	fsnotify_put_mark(fsn_mark);
 
