CVE Number : CVE-2011-1748
Commit Message : 
can: add missing socket check in can/raw release
Commit Details : 
v2: added space after 'if' according code style.

We can get here with a NULL socket argument passed from userspace,
so we need to handle it accordingly.

Thanks to Dave Jones pointing at this issue in net/can/bcm.c

Signed-off-by: Oliver Hartkopp <socketcan@hartkopp.net>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 static int raw_release(struct socket *sock)
 {
 	struct sock *sk = sock >sk;
 	struct raw_sock *ro = raw_sk(sk);
 
 	unregister_netdevice_notifier(&ro >notifier);
 
After patch : 
 static int raw_release(struct socket *sock)
 {
 	struct sock *sk = sock >sk;
 	struct raw_sock *ro;
 
 	if (!sk)
 		return 0;
 
 	ro = raw_sk(sk);
 
 	unregister_netdevice_notifier(&ro >notifier);
 
