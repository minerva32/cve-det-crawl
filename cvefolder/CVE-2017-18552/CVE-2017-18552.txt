CVE Number : CVE-2017-18552
Commit Message : 
RDS: validate the requested traces user input against max supported
Commit Details : 
Larger than supported value can lead to array read/write overflow.

Reported-by: Colin Ian King <colin.king@canonical.com>
Signed-off-by: Santosh Shilimkar <santosh.shilimkar@oracle.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	if (copy_from_user(&trace, optval, sizeof(trace)))
 		return  EFAULT;
 
 	rs >rs_rx_traces = trace.rx_traces;
 	for (i = 0; i < rs >rs_rx_traces; i  ) {
 		if (trace.rx_trace_pos[i] > RDS_MSG_RX_DGRAM_TRACE_MAX) {
After patch : 
 	if (copy_from_user(&trace, optval, sizeof(trace)))
 		return  EFAULT;
 
 	if (trace.rx_traces > RDS_MSG_RX_DGRAM_TRACE_MAX)
 		return  EFAULT;
 
 	rs >rs_rx_traces = trace.rx_traces;
 	for (i = 0; i < rs >rs_rx_traces; i  ) {
 		if (trace.rx_trace_pos[i] > RDS_MSG_RX_DGRAM_TRACE_MAX) {
