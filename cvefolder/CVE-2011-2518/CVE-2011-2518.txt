CVE Number : CVE-2011-2518
Commit Message : 
TOMOYO: Fix oops in tomoyo_mount_acl().
Commit Details : 
In tomoyo_mount_acl() since 2.6.36, kern_path() was called without checking
dev_name != NULL. As a result, an unprivileged user can trigger oops by issuing
mount(NULL, "/", "ext3", 0, NULL) request.
Fix this by checking dev_name != NULL before calling kern_path(dev_name).

Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
Cc: stable@kernel.org
Signed-off-by: James Morris <jmorris@namei.org>

Before patch : 
 	}
 	if (need_dev) {
 		/* Get mount point or device file. */
 		if (kern_path(dev_name, LOOKUP_FOLLOW, &path)) {
 			error =  ENOENT;
 			goto out;
 		}
After patch : 
 	}
 	if (need_dev) {
 		/* Get mount point or device file. */
 		if (!dev_name || kern_path(dev_name, LOOKUP_FOLLOW, &path)) {
 			error =  ENOENT;
 			goto out;
 		}
