CVE Number : CVE-2016-6516
Commit Message : 
vfs: ioctl: prevent double-fetch in dedupe ioctl
Commit Details : 
This prevents a double-fetch from user space that can lead to to an
undersized allocation and heap overflow.

Fixes: 54dbc1517237 ("vfs: hoist the btrfs deduplication ioctl to the vfs")
Signed-off-by: Scott Bauer <sbauer@plzdonthack.me>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 		goto out;
 	}
 
 	ret = vfs_dedupe_file_range(file, same);
 	if (ret)
 		goto out;
After patch : 
 		goto out;
 	}
 
 	same >dest_count = count;
 	ret = vfs_dedupe_file_range(file, same);
 	if (ret)
 		goto out;
