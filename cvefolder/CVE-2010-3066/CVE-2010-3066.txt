CVE Number : CVE-2010-3066
Commit Message : 
AIO: fix cleanup in io_submit_one(...)
Commit Details : 
When IOCB_FLAG_RESFD flag is set and iocb->aio_resfd is incorrect,
statement 'goto out_put_req' is executed. At label 'out_put_req',
aio_put_req(..) is called, which requires 'req->ki_filp' set.

Signed-off-by: Yan Zheng<yanzheng@21cn.com>
Cc: Zach Brown <zach.brown@oracle.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 		fput(file);
 		return  EAGAIN;
 	}
 	if (iocb >aio_flags & IOCB_FLAG_RESFD) {
 		/*
 		 * If the IOCB_FLAG_RESFD flag of aio_flags is set, get an
 		}
 	}
 
 	req >ki_filp = file;
 	ret = put_user(req >ki_key, &user_iocb >aio_key);
 	if (unlikely(ret)) {
 		dprintk("EFAULT: aio_key\n");
After patch : 
 		fput(file);
 		return  EAGAIN;
 	}
 	req >ki_filp = file;
 	if (iocb >aio_flags & IOCB_FLAG_RESFD) {
 		/*
 		 * If the IOCB_FLAG_RESFD flag of aio_flags is set, get an
 		}
 	}
 
 	ret = put_user(req >ki_key, &user_iocb >aio_key);
 	if (unlikely(ret)) {
 		dprintk("EFAULT: aio_key\n");
