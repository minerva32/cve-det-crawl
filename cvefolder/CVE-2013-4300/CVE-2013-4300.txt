CVE Number : CVE-2013-4300
Commit Message : 
net: Check the correct namespace when spoofing pid over SCM_RIGHTS
Commit Details : 
This is a security bug.

The follow-up will fix nsproxy to discourage this type of issue from
happening again.

Cc: stable@vger.kernel.org
Signed-off-by: Andy Lutomirski <luto@amacapital.net>
Reviewed-by: "Eric W. Biederman" <ebiederm@xmission.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 		return  EINVAL;
 
 	if ((creds >pid == task_tgid_vnr(current) ||
 	     ns_capable(current >nsproxy >pid_ns >user_ns, CAP_SYS_ADMIN)) &&
 	    ((uid_eq(uid, cred >uid)   || uid_eq(uid, cred >euid) ||
 	      uid_eq(uid, cred >suid)) || nsown_capable(CAP_SETUID)) &&
 	    ((gid_eq(gid, cred >gid)   || gid_eq(gid, cred >egid) ||
After patch : 
 		return  EINVAL;
 
 	if ((creds >pid == task_tgid_vnr(current) ||
 	     ns_capable(task_active_pid_ns(current) >user_ns, CAP_SYS_ADMIN)) &&
 	    ((uid_eq(uid, cred >uid)   || uid_eq(uid, cred >euid) ||
 	      uid_eq(uid, cred >suid)) || nsown_capable(CAP_SETUID)) &&
 	    ((gid_eq(gid, cred >gid)   || gid_eq(gid, cred >egid) ||
