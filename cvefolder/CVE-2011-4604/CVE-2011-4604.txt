CVE Number : CVE-2011-4604
Commit Message : 
batman-adv: Only write requested number of byte to user buffer
Commit Details : 
Don't write more than the requested number of bytes of an batman-adv icmp
packet to the userspace buffer. Otherwise unrelated userspace memory might get
overridden by the kernel.

Signed-off-by: Sven Eckelmann <sven@narfation.org>
Signed-off-by: Marek Lindner <lindner_marek@yahoo.de>

Before patch : 
 
 	spin_unlock_bh(&socket_client >lock);
 
 	error = copy_to_user(buf, &socket_packet >icmp_packet,
 			     socket_packet >icmp_len);
 
 	packet_len = socket_packet >icmp_len;
 	kfree(socket_packet);
 
 	if (error)
After patch : 
 
 	spin_unlock_bh(&socket_client >lock);
 
 	packet_len = min(count, socket_packet >icmp_len);
 	error = copy_to_user(buf, &socket_packet >icmp_packet, packet_len);
 
 	kfree(socket_packet);
 
 	if (error)
