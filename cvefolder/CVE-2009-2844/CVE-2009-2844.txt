CVE Number : CVE-2009-2844
Commit Message : 
cfg80211: add two missing NULL pointer checks
Commit Details : 
These pointers can be NULL, the is_mesh() case isn't
ever hit in the current kernel, but cmp_ies() can be
hit under certain conditions.

Signed-off-by: Johannes Berg <johannes@sipsolutions.net>
Cc: stable@kernel.org 2.6.29, 2.6.30
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Before patch : 
 
 	if (!ie1 && !ie2)
 		return 0;
 	if (!ie1)
 		return  1;
 
 	r = memcmp(ie1   2, ie2   2, min(ie1[1], ie2[1]));
 	ie = find_ie(WLAN_EID_MESH_CONFIG,
 		     a >information_elements,
 		     a >len_information_elements);
 	if (ie[1] != IEEE80211_MESH_CONFIG_LEN)
 		return false;
 
After patch : 
 
 	if (!ie1 && !ie2)
 		return 0;
 	if (!ie1 || !ie2)
 		return  1;
 
 	r = memcmp(ie1   2, ie2   2, min(ie1[1], ie2[1]));
 	ie = find_ie(WLAN_EID_MESH_CONFIG,
 		     a >information_elements,
 		     a >len_information_elements);
 	if (!ie)
 		return false;
 	if (ie[1] != IEEE80211_MESH_CONFIG_LEN)
 		return false;
 
