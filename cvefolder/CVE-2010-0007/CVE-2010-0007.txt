CVE Number : CVE-2010-0007
Commit Message : 
netfilter: ebtables: enforce CAP_NET_ADMIN
Commit Details : 
normal users are currently allowed to set/modify ebtables rules.
Restrict it to processes with CAP_NET_ADMIN.

Note that this cannot be reproduced with unmodified ebtables binary
because it uses SOCK_RAW.

Signed-off-by: Florian Westphal <fwestphal@astaro.com>
Cc: stable@kernel.org
Signed-off-by: Patrick McHardy <kaber@trash.net>

Before patch : 
 {
 	int ret;
 
 	switch(cmd) {
 	case EBT_SO_SET_ENTRIES:
 		ret = do_replace(sock_net(sk), user, len);
 	struct ebt_replace tmp;
 	struct ebt_table *t;
 
 	if (copy_from_user(&tmp, user, sizeof(tmp)))
 		return  EFAULT;
 
After patch : 
 {
 	int ret;
 
 	if (!capable(CAP_NET_ADMIN))
 		return  EPERM;
 
 	switch(cmd) {
 	case EBT_SO_SET_ENTRIES:
 		ret = do_replace(sock_net(sk), user, len);
 	struct ebt_replace tmp;
 	struct ebt_table *t;
 
 	if (!capable(CAP_NET_ADMIN))
 		return  EPERM;
 
 	if (copy_from_user(&tmp, user, sizeof(tmp)))
 		return  EFAULT;
 
