CVE Number : CVE-2014-3181
Commit Message : 
HID: magicmouse: sanity check report size in raw_event() callback
Commit Details : 
The report passed to us from transport driver could potentially be
arbitrarily large, therefore we better sanity-check it so that
magicmouse_emit_touch() gets only valid values of raw_id.

Cc: stable@vger.kernel.org
Reported-by: Steven Vittitoe <scvitti@google.com>
Signed-off-by: Jiri Kosina <jkosina@suse.cz>

Before patch : 
 		if (size < 4 || ((size   4) % 9) != 0)
 			return 0;
 		npoints = (size   4) / 9;
 		msc >ntouches = 0;
 		for (ii = 0; ii < npoints; ii  )
 			magicmouse_emit_touch(msc, ii, data   ii * 9   4);
 		if (size < 6 || ((size   6) % 8) != 0)
 			return 0;
 		npoints = (size   6) / 8;
 		msc >ntouches = 0;
 		for (ii = 0; ii < npoints; ii  )
 			magicmouse_emit_touch(msc, ii, data   ii * 8   6);
After patch : 
 		if (size < 4 || ((size   4) % 9) != 0)
 			return 0;
 		npoints = (size   4) / 9;
 		if (npoints > 15) {
 			hid_warn(hdev, "invalid size value (%d) for TRACKPAD_REPORT_ID\n",
 					size);
 			return 0;
 		}
 		msc >ntouches = 0;
 		for (ii = 0; ii < npoints; ii  )
 			magicmouse_emit_touch(msc, ii, data   ii * 9   4);
 		if (size < 6 || ((size   6) % 8) != 0)
 			return 0;
 		npoints = (size   6) / 8;
 		if (npoints > 15) {
 			hid_warn(hdev, "invalid size value (%d) for MOUSE_REPORT_ID\n",
 					size);
 			return 0;
 		}
 		msc >ntouches = 0;
 		for (ii = 0; ii < npoints; ii  )
 			magicmouse_emit_touch(msc, ii, data   ii * 8   6);
