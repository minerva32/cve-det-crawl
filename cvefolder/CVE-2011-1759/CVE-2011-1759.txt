CVE Number : CVE-2011-1759
Commit Message : 
ARM: 6891/1: prevent heap corruption in OABI semtimedop
Commit Details : 
When CONFIG_OABI_COMPAT is set, the wrapper for semtimedop does not
bound the nsops argument.  A sufficiently large value will cause an
integer overflow in allocation size, followed by copying too much data
into the allocated buffer.  Fix this by restricting nsops to SEMOPM.
Untested.

Cc: stable@kernel.org
Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com>
Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

Before patch : 
 	long err;
 	int i;
 
 	if (nsops < 1)
 		return  EINVAL;
 	sops = kmalloc(sizeof(*sops) * nsops, GFP_KERNEL);
 	if (!sops)
After patch : 
 	long err;
 	int i;
 
 	if (nsops < 1 || nsops > SEMOPM)
 		return  EINVAL;
 	sops = kmalloc(sizeof(*sops) * nsops, GFP_KERNEL);
 	if (!sops)
