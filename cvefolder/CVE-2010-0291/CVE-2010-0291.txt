CVE Number : CVE-2010-0291
Commit Message : 
Kill ancient crap in s390 compat mmap
Commit Details : 
We've had TASK_SIZE set to 1<<31 for 31bit tasks since May 2004.
Before that old32_mmap() had to deal with do_mmap_pgoff() giving
it an address out of range.  It had tried to do that by checking
return value and doing do_munmap() (at wrong address, BTW).

IOW, that code had been dead for 5.5 years (and bogus - for 8).
Kill.

Acked-by: Hugh Dickins <hugh.dickins@tiscali.co.uk>
Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

Before patch : 
 
 	down_write(&current >mm >mmap_sem);
 	error = do_mmap_pgoff(file, addr, len, prot, flags, pgoff);
 	if (!IS_ERR((void *) error) && error   len >= 0x80000000ULL) {
 		/* Result is out of bounds.  */
 		do_munmap(current >mm, addr, len);
 		error =  ENOMEM;
 	}
 	up_write(&current >mm >mmap_sem);
 
 	if (file)
After patch : 
 
 	down_write(&current >mm >mmap_sem);
 	error = do_mmap_pgoff(file, addr, len, prot, flags, pgoff);
 	up_write(&current >mm >mmap_sem);
 
 	if (file)
