CVE Number : CVE-2015-4692
Commit Message : 
kvm: x86: fix kvm_apic_has_events to check for NULL pointer
Commit Details : 
Malicious (or egregiously buggy) userspace can trigger it, but it
should never happen in normal operation.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Before patch : 
 
 static inline bool kvm_apic_has_events(struct kvm_vcpu *vcpu)
 {
 	return vcpu >arch.apic >pending_events;
 }
 
 static inline bool kvm_lowest_prio_delivery(struct kvm_lapic_irq *irq)
After patch : 
 
 static inline bool kvm_apic_has_events(struct kvm_vcpu *vcpu)
 {
 	return kvm_vcpu_has_lapic(vcpu) && vcpu >arch.apic >pending_events;
 }
 
 static inline bool kvm_lowest_prio_delivery(struct kvm_lapic_irq *irq)
