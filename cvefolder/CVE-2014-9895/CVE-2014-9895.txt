CVE Number : CVE-2014-9895
Commit Message : 
media media: info leak in __media_device_enum_links()
Commit Details : 
These structs have holes and reserved struct members which aren't
cleared.  I've added a memset() so we don't leak stack information.

Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

Before patch : 
 
 		for (p = 0; p < entity >num_pads; p  ) {
 			struct media_pad_desc pad;
 			media_device_kpad_to_upad(&entity >pads[p], &pad);
 			if (copy_to_user(&links >pads[p], &pad, sizeof(pad)))
 				return  EFAULT;
 			if (entity >links[l].source >entity != entity)
 				continue;
 
 			media_device_kpad_to_upad(entity >links[l].source,
 						  &link.source);
 			media_device_kpad_to_upad(entity >links[l].sink,
After patch : 
 
 		for (p = 0; p < entity >num_pads; p  ) {
 			struct media_pad_desc pad;
 
 			memset(&pad, 0, sizeof(pad));
 			media_device_kpad_to_upad(&entity >pads[p], &pad);
 			if (copy_to_user(&links >pads[p], &pad, sizeof(pad)))
 				return  EFAULT;
 			if (entity >links[l].source >entity != entity)
 				continue;
 
 			memset(&link, 0, sizeof(link));
 			media_device_kpad_to_upad(entity >links[l].source,
 						  &link.source);
 			media_device_kpad_to_upad(entity >links[l].sink,
