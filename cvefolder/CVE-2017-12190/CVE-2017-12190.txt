CVE Number : CVE-2017-12190
Commit Message : 
fix unbalanced page refcounting in bio_map_user_iov
Commit Details : 
bio_map_user_iov and bio_unmap_user do unbalanced pages refcounting if
IO vector has small consecutive buffers belonging to the same page.
bio_add_pc_page merges them into one, but the page reference is never
dropped.

Cc: stable@vger.kernel.org
Signed-off-by: Vitaly Mayatskikh <v.mayatskih@gmail.com>
Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

Before patch : 
 		offset = offset_in_page(uaddr);
 		for (j = cur_page; j < page_limit; j  ) {
 			unsigned int bytes = PAGE_SIZE   offset;
 
 			if (len <= 0)
 				break;
 					    bytes)
 				break;
 
 			len  = bytes;
 			offset = 0;
 		}
After patch : 
 		offset = offset_in_page(uaddr);
 		for (j = cur_page; j < page_limit; j  ) {
 			unsigned int bytes = PAGE_SIZE   offset;
 			unsigned short prev_bi_vcnt = bio >bi_vcnt;
 
 			if (len <= 0)
 				break;
 					    bytes)
 				break;
 
 			/*
 			 * check if vector was merged with previous
 			 * drop page reference if needed
 			 */
 			if (bio >bi_vcnt == prev_bi_vcnt)
 				put_page(pages[j]);
 
 			len  = bytes;
 			offset = 0;
 		}
