CVE Number : CVE-2005-4881
Commit Message : 
NETLINK: Clear padding in netlink messages
Commit Details : 
Signed-off-by: Patrick McHardy <kaber@trash.net>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	nlh >nlmsg_flags = flags;
 	nlh >nlmsg_pid = pid;
 	nlh >nlmsg_seq = seq;
 	return nlh;
 }
 
 	memcpy(skb_put(skb, attrlen), data, attrlen); })
 
 #define RTA_PUT_NOHDR(skb, attrlen, data) \
 	RTA_APPEND(skb, RTA_ALIGN(attrlen), data)
 
 #define RTA_PUT_U8(skb, attrtype, value) \
 ({	u8 _tmp = (value); \
 	rta = (struct rtattr*)skb_put(skb, RTA_ALIGN(size));
 	rta >rta_type = attrtype;
 	rta >rta_len = size;
 	return rta;
 }
 
 	rta >rta_type = attrtype;
 	rta >rta_len = size;
 	memcpy(RTA_DATA(rta), data, attrlen);
 }
 
 size_t rtattr_strlcpy(char *dest, const struct rtattr *rta, size_t size)
After patch : 
 	nlh >nlmsg_flags = flags;
 	nlh >nlmsg_pid = pid;
 	nlh >nlmsg_seq = seq;
 	memset(NLMSG_DATA(nlh)   len, 0, NLMSG_ALIGN(size)   size);
 	return nlh;
 }
 
 	memcpy(skb_put(skb, attrlen), data, attrlen); })
 
 #define RTA_PUT_NOHDR(skb, attrlen, data) \
 ({	RTA_APPEND(skb, RTA_ALIGN(attrlen), data); \
 	memset(skb >tail   (RTA_ALIGN(attrlen)   attrlen), 0, \
 	       RTA_ALIGN(attrlen)   attrlen); })
 
 #define RTA_PUT_U8(skb, attrtype, value) \
 ({	u8 _tmp = (value); \
 	rta = (struct rtattr*)skb_put(skb, RTA_ALIGN(size));
 	rta >rta_type = attrtype;
 	rta >rta_len = size;
 	memset(RTA_DATA(rta)   attrlen, 0, RTA_ALIGN(size)   size);
 	return rta;
 }
 
 	rta >rta_type = attrtype;
 	rta >rta_len = size;
 	memcpy(RTA_DATA(rta), data, attrlen);
 	memset(RTA_DATA(rta)   attrlen, 0, RTA_ALIGN(size)   size);
 }
 
 size_t rtattr_strlcpy(char *dest, const struct rtattr *rta, size_t size)
