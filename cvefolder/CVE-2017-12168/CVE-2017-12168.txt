CVE Number : CVE-2017-12168
Commit Message : 
arm64: KVM: pmu: Fix AArch32 cycle counter access
Commit Details : 
We're missing the handling code for the cycle counter accessed
from a 32bit guest, leading to unexpected results.

Cc: stable@vger.kernel.org # 4.6+
Signed-off-by: Wei Huang <wei@redhat.com>
Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

Before patch : 
 
 			idx = ARMV8_PMU_CYCLE_IDX;
 		} else {
 			BUG();
 		}
 	} else if (r >CRn == 14 && (r >CRm & 12) == 8) {
 		/* PMEVCNTRn_EL0 */
 		if (pmu_access_event_counter_el0_disabled(vcpu))
 
 		idx = ((r >CRm & 3) << 3) | (r >Op2 & 7);
 	} else {
 		BUG();
 	}
 
 	if (!pmu_counter_idx_valid(vcpu, idx))
After patch : 
 
 			idx = ARMV8_PMU_CYCLE_IDX;
 		} else {
 			return false;
 		}
 	} else if (r >CRn == 0 && r >CRm == 9) {
 		/* PMCCNTR */
 		if (pmu_access_event_counter_el0_disabled(vcpu))
 			return false;
 
 		idx = ARMV8_PMU_CYCLE_IDX;
 	} else if (r >CRn == 14 && (r >CRm & 12) == 8) {
 		/* PMEVCNTRn_EL0 */
 		if (pmu_access_event_counter_el0_disabled(vcpu))
 
 		idx = ((r >CRm & 3) << 3) | (r >Op2 & 7);
 	} else {
 		return false;
 	}
 
 	if (!pmu_counter_idx_valid(vcpu, idx))
