CVE Number : CVE-2016-3689
Commit Message : 
Input: ims-pcu - sanity check against missing interfaces
Commit Details : 
A malicious device missing interface can make the driver oops.
Add sanity checking.

Signed-off-by: Oliver Neukum <ONeukum@suse.com>
CC: stable@vger.kernel.org
Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
Before patch : 
 
 	pcu >ctrl_intf = usb_ifnum_to_if(pcu >udev,
 					 union_desc >bMasterInterface0);
 
 	alt = pcu >ctrl_intf >cur_altsetting;
 	pcu >ep_ctrl = &alt >endpoint[0].desc;
 
 	pcu >data_intf = usb_ifnum_to_if(pcu >udev,
 					 union_desc >bSlaveInterface0);
 
 	alt = pcu >data_intf >cur_altsetting;
 	if (alt >desc.bNumEndpoints != 2) {
After patch : 
 
 	pcu >ctrl_intf = usb_ifnum_to_if(pcu >udev,
 					 union_desc >bMasterInterface0);
 	if (!pcu >ctrl_intf)
 		return  EINVAL;
 
 	alt = pcu >ctrl_intf >cur_altsetting;
 	pcu >ep_ctrl = &alt >endpoint[0].desc;
 
 	pcu >data_intf = usb_ifnum_to_if(pcu >udev,
 					 union_desc >bSlaveInterface0);
 	if (!pcu >data_intf)
 		return  EINVAL;
 
 	alt = pcu >data_intf >cur_altsetting;
 	if (alt >desc.bNumEndpoints != 2) {
