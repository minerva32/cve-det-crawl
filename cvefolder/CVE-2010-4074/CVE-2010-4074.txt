CVE Number : CVE-2010-4074
Commit Message : 
USB: serial/mos*: prevent reading uninitialized stack memory
Commit Details : 
The TIOCGICOUNT device ioctl in both mos7720.c and mos7840.c allows
unprivileged users to read uninitialized stack memory, because the
"reserved" member of the serial_icounter_struct struct declared on the
stack is not altered or zeroed before being copied back to the user.
This patch takes care of it.

Signed-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>
Cc: stable <stable@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>


Before patch : 
 
 	case TIOCGICOUNT:
 		cnow = mos7720_port >icount;
 		icount.cts = cnow.cts;
 		icount.dsr = cnow.dsr;
 		icount.rng = cnow.rng;
 	case TIOCGICOUNT:
 		cnow = mos7840_port >icount;
 		smp_rmb();
 		icount.cts = cnow.cts;
 		icount.dsr = cnow.dsr;
 		icount.rng = cnow.rng;
After patch : 
 
 	case TIOCGICOUNT:
 		cnow = mos7720_port >icount;
 
 		memset(&icount, 0, sizeof(struct serial_icounter_struct));
 
 		icount.cts = cnow.cts;
 		icount.dsr = cnow.dsr;
 		icount.rng = cnow.rng;
 	case TIOCGICOUNT:
 		cnow = mos7840_port >icount;
 		smp_rmb();
 
 		memset(&icount, 0, sizeof(struct serial_icounter_struct));
 
 		icount.cts = cnow.cts;
 		icount.dsr = cnow.dsr;
 		icount.rng = cnow.rng;
