CVE Number : CVE-2011-1477
Commit Message : 
sound/oss/opl3: validate voice and channel indexes
Commit Details : 
User-controllable indexes for voice and channel values may cause reading
and writing beyond the bounds of their respective arrays, leading to
potentially exploitable memory corruption.  Validate these indexes.

Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com>
Cc: stable@kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>

Before patch : 
 
 static void opl3_panning(int dev, int voice, int value)
 {
 	devc >voc[voice].panning = value;
 }
 
 
 static void opl3_setup_voice(int dev, int voice, int chn)
 {
 	struct channel_info *info =
 	&synth_devs[dev] >chn_info[chn];
 
 	opl3_set_instr(dev, voice, info >pgm_num);
 
After patch : 
 
 static void opl3_panning(int dev, int voice, int value)
 {
 
 	if (voice < 0 || voice >= devc >nr_voice)
 		return;
 
 	devc >voc[voice].panning = value;
 }
 
 
 static void opl3_setup_voice(int dev, int voice, int chn)
 {
 	struct channel_info *info;
 
 	if (voice < 0 || voice >= devc >nr_voice)
 		return;
 
 	if (chn < 0 || chn > 15)
 		return;
 
 	info = &synth_devs[dev] >chn_info[chn];
 
 	opl3_set_instr(dev, voice, info >pgm_num);
 
