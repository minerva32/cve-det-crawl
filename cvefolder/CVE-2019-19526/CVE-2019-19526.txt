CVE Number : CVE-2019-19526
Commit Message : 
NFC: pn533: fix use-after-free and memleaks
Commit Details : 
The driver would fail to deregister and its class device and free
related resources on late probe errors.

Reported-by: syzbot+cb035c75c03dbe34b796@syzkaller.appspotmail.com
Fixes: 32ecc75ded72 ("NFC: pn533: change order operations in dev registation")
Signed-off-by: Johan Hovold <johan@kernel.org>
Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>

Before patch : 
 
 	rc = pn533_finalize_setup(priv);
 	if (rc)
 		goto error;
 
 	usb_set_intfdata(interface, phy);
 
 	return 0;
 
 error:
 	usb_free_urb(phy >in_urb);
 	usb_free_urb(phy >out_urb);
 	usb_free_urb(phy >ack_urb);
 	usb_put_dev(phy >udev);
 	kfree(in_buf);
 
 	return rc;
 }
After patch : 
 
 	rc = pn533_finalize_setup(priv);
 	if (rc)
 		goto err_deregister;
 
 	usb_set_intfdata(interface, phy);
 
 	return 0;
 
 err_deregister:
 	pn533_unregister_device(phy >priv);
 error:
 	usb_kill_urb(phy >in_urb);
 	usb_kill_urb(phy >out_urb);
 	usb_kill_urb(phy >ack_urb);
 
 	usb_free_urb(phy >in_urb);
 	usb_free_urb(phy >out_urb);
 	usb_free_urb(phy >ack_urb);
 	usb_put_dev(phy >udev);
 	kfree(in_buf);
 	kfree(phy >ack_buffer);
 
 	return rc;
 }
