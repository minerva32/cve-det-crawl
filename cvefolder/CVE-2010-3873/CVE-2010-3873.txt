CVE Number : CVE-2010-3873
Commit Message : 
memory corruption in X.25 facilities parsing
Commit Details : 
Signed-of-by: Andrew Hendry <andrew.hendry@gmail.com>

Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 		case X25_FAC_CLASS_D:
 			switch (*p) {
 			case X25_FAC_CALLING_AE:
 				if (p[1] > X25_MAX_DTE_FACIL_LEN)
 					break;
 				dte_facs >calling_len = p[2];
 				memcpy(dte_facs >calling_ae, &p[3], p[1]   1);
 				*vc_fac_mask |= X25_MASK_CALLING_AE;
 				break;
 			case X25_FAC_CALLED_AE:
 				if (p[1] > X25_MAX_DTE_FACIL_LEN)
 					break;
 				dte_facs >called_len = p[2];
 				memcpy(dte_facs >called_ae, &p[3], p[1]   1);
 				*vc_fac_mask |= X25_MASK_CALLED_AE;
 						&x25 >vc_facil_mask);
 			if (len > 0)
 				skb_pull(skb, len);
 			/*
 			 *	Copy any Call User Data.
 			 */
After patch : 
 		case X25_FAC_CLASS_D:
 			switch (*p) {
 			case X25_FAC_CALLING_AE:
 				if (p[1] > X25_MAX_DTE_FACIL_LEN || p[1] <= 1)
 					return 0;
 				dte_facs >calling_len = p[2];
 				memcpy(dte_facs >calling_ae, &p[3], p[1]   1);
 				*vc_fac_mask |= X25_MASK_CALLING_AE;
 				break;
 			case X25_FAC_CALLED_AE:
 				if (p[1] > X25_MAX_DTE_FACIL_LEN || p[1] <= 1)
 					return 0;
 				dte_facs >called_len = p[2];
 				memcpy(dte_facs >called_ae, &p[3], p[1]   1);
 				*vc_fac_mask |= X25_MASK_CALLED_AE;
 						&x25 >vc_facil_mask);
 			if (len > 0)
 				skb_pull(skb, len);
 			else
 				return  1;
 			/*
 			 *	Copy any Call User Data.
 			 */
