CVE Number : CVE-2010-4656
Commit Message : 
usb: iowarrior: don't trust report_size for buffer size
Commit Details : 
If the iowarrior devices in this case statement support more than 8 bytes
per report, it is possible to write past the end of a kernel heap allocation.
This will probably never be possible, but change the allocation to be more
defensive anyway.

Signed-off-by: Kees Cook <kees.cook@canonical.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>


Before patch : 
 	case USB_DEVICE_ID_CODEMERCS_IOWPV2:
 	case USB_DEVICE_ID_CODEMERCS_IOW40:
 		/* IOW24 and IOW40 use a synchronous call */
 		buf = kmalloc(8, GFP_KERNEL);	/* 8 bytes are enough for both products */
 		if (!buf) {
 			retval =  ENOMEM;
 			goto exit;
After patch : 
 	case USB_DEVICE_ID_CODEMERCS_IOWPV2:
 	case USB_DEVICE_ID_CODEMERCS_IOW40:
 		/* IOW24 and IOW40 use a synchronous call */
 		buf = kmalloc(count, GFP_KERNEL);
 		if (!buf) {
 			retval =  ENOMEM;
 			goto exit;
