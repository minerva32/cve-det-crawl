CVE Number : CVE-2016-2544
Commit Message : 
ALSA: seq: Fix race at timer setup and close
Commit Details : 
ALSA sequencer code has an open race between the timer setup ioctl and
the close of the client.  This was triggered by syzkaller fuzzer, and
a use-after-free was caught there as a result.

This patch papers over it by adding a proper queue->timer_mutex lock
around the timer-related calls in the relevant code path.

Reported-by: Dmitry Vyukov <dvyukov@google.com>
Tested-by: Dmitry Vyukov <dvyukov@google.com>
Cc: <stable@vger.kernel.org>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

Before patch : 
 static void queue_delete(struct snd_seq_queue *q)
 {
 	/* stop and release the timer */
 	snd_seq_timer_stop(q >timer);
 	snd_seq_timer_close(q);
 	/* wait until access free */
 	snd_use_lock_sync(&q >use_lock);
 	/* release resources... */
After patch : 
 static void queue_delete(struct snd_seq_queue *q)
 {
 	/* stop and release the timer */
 	mutex_lock(&q >timer_mutex);
 	snd_seq_timer_stop(q >timer);
 	snd_seq_timer_close(q);
 	mutex_unlock(&q >timer_mutex);
 	/* wait until access free */
 	snd_use_lock_sync(&q >use_lock);
 	/* release resources... */
