CVE Number : CVE-2021-3489
Commit Message : 
bpf, ringbuf: Deny reserve of buffers larger than ringbuf
Commit Details : 
A BPF program might try to reserve a buffer larger than the ringbuf size.
If the consumer pointer is way ahead of the producer, that would be
successfully reserved, allowing the BPF program to read or write out of
the ringbuf allocated area.

Reported-by: Ryota Shiga (Flatt Security)
Fixes: 457f44363a88 ("bpf: Implement BPF ring buffer and verifier support for it")
Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@canonical.com>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Acked-by: Andrii Nakryiko <andrii@kernel.org>
Acked-by: Alexei Starovoitov <ast@kernel.org>

Before patch : 
 		return NULL;
 
 	len = round_up(size   BPF_RINGBUF_HDR_SZ, 8);
 	cons_pos = smp_load_acquire(&rb >consumer_pos);
 
 	if (in_nmi()) {
After patch : 
 		return NULL;
 
 	len = round_up(size   BPF_RINGBUF_HDR_SZ, 8);
 	if (len > rb >mask   1)
 		return NULL;
 
 	cons_pos = smp_load_acquire(&rb >consumer_pos);
 
 	if (in_nmi()) {
