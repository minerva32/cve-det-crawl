CVE Number : CVE-2013-1763
Commit Message : 
sock_diag: Fix out-of-bounds access to sock_diag_handlers
Commit Details : 
Userland can send a netlink message requesting SOCK_DIAG_BY_FAMILY
with a family greater or equal then AF_MAX -- the array size of
sock_diag_handlers. The current code does not test for this
condition therefore is vulnerable to an out-of-bound access opening
doors for a privilege escalation.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Acked-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	if (nlmsg_len(nlh) < sizeof(*req))
 		return  EINVAL;
 
 	hndl = sock_diag_lock_handler(req >sdiag_family);
 	if (hndl == NULL)
 		err =  ENOENT;
After patch : 
 	if (nlmsg_len(nlh) < sizeof(*req))
 		return  EINVAL;
 
 	if (req >sdiag_family >= AF_MAX)
 		return  EINVAL;
 
 	hndl = sock_diag_lock_handler(req >sdiag_family);
 	if (hndl == NULL)
 		err =  ENOENT;
