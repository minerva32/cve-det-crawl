CVE Number : CVE-2011-3359
Commit Message : 
b43: allocate receive buffers big enough for max frame len + offset
Commit Details : 
Otherwise, skb_put inside of dma_rx can fail...

	https://bugzilla.kernel.org/show_bug.cgi?id=32042

Signed-off-by: John W. Linville <linville@tuxdriver.com>
Acked-by: Larry Finger <Larry.Finger@lwfinger.net>
Cc: stable@kernel.org

Before patch : 
 		dmaaddr = meta >dmaaddr;
 		goto drop_recycle_buffer;
 	}
 	if (unlikely(len > ring >rx_buffersize)) {
 		/* The data did not fit into one descriptor buffer
 		 * and is split over multiple buffers.
 		 * This should never happen, as we try to allocate buffers
 /* DMA engine tuning knobs */
 #define B43_TXRING_SLOTS		256
 #define B43_RXRING_SLOTS		64
 #define B43_DMA0_RX_BUFFERSIZE		IEEE80211_MAX_FRAME_LEN
 
 /* Pointer poison */
 #define B43_DMA_PTR_POISON		((void *)ERR_PTR( ENOMEM))
After patch : 
 		dmaaddr = meta >dmaaddr;
 		goto drop_recycle_buffer;
 	}
 	if (unlikely(len   ring >frameoffset > ring >rx_buffersize)) {
 		/* The data did not fit into one descriptor buffer
 		 * and is split over multiple buffers.
 		 * This should never happen, as we try to allocate buffers
 /* DMA engine tuning knobs */
 #define B43_TXRING_SLOTS		256
 #define B43_RXRING_SLOTS		64
 #define B43_DMA0_RX_BUFFERSIZE		(B43_DMA0_RX_FRAMEOFFSET   IEEE80211_MAX_FRAME_LEN)
 
 /* Pointer poison */
 #define B43_DMA_PTR_POISON		((void *)ERR_PTR( ENOMEM))
