CVE Number : CVE-2010-4165
Commit Message : 
tcp: Increase TCP_MAXSEG socket option minimum.
Commit Details : 
As noted by Steve Chen, since commit
f5fff5dc8a7a3f395b0525c02ba92c95d42b7390 ("tcp: advertise MSS
requested by user") we can end up with a situation where
tcp_select_initial_window() does a divide by a zero (or
even negative) mss value.

The problem is that sometimes we effectively subtract
TCPOLEN_TSTAMP_ALIGNED and/or TCPOLEN_MD5SIG_ALIGNED from the mss.

Fix this by increasing the minimum from 8 to 64.

Reported-by: Steve Chen <schen@mvista.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 		/* Values greater than interface MTU won't take effect. However
 		 * at the point when this call is done we typically don't yet
 		 * know which interface is going to be used */
 		if (val < 8 || val > MAX_TCP_WINDOW) {
 			err =  EINVAL;
 			break;
 		}
After patch : 
 		/* Values greater than interface MTU won't take effect. However
 		 * at the point when this call is done we typically don't yet
 		 * know which interface is going to be used */
 		if (val < 64 || val > MAX_TCP_WINDOW) {
 			err =  EINVAL;
 			break;
 		}
