CVE Number : CVE-2012-2669
Commit Message : 
Tools: hv: verify origin of netlink connector message
Commit Details : 
The SuSE security team suggested to use recvfrom instead of recv to be
certain that the connector message is originated from kernel.

CVE-2012-2669

Signed-off-by: Olaf Hering <olaf@aepfle.de>
Signed-off-by: Marcus Meissner <meissner@suse.de>
Signed-off-by: Sebastian Krahmer <krahmer@suse.de>
Signed-off-by: K. Y. Srinivasan <kys@microsoft.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

Before patch : 
 	pfd.fd = fd;
 
 	while (1) {
 		pfd.events = POLLIN;
 		pfd.revents = 0;
 		poll(&pfd, 1,  1);
 
 		len = recv(fd, kvp_recv_buffer, sizeof(kvp_recv_buffer), 0);
 
 		if (len < 0) {
 			syslog(LOG_ERR, "recv failed; error:%d", len);
 			close(fd);
 			return  1;
 		}
After patch : 
 	pfd.fd = fd;
 
 	while (1) {
 		struct sockaddr *addr_p = (struct sockaddr *) &addr;
 		socklen_t addr_l = sizeof(addr);
 		pfd.events = POLLIN;
 		pfd.revents = 0;
 		poll(&pfd, 1,  1);
 
 		len = recvfrom(fd, kvp_recv_buffer, sizeof(kvp_recv_buffer), 0,
 				addr_p, &addr_l);
 
 		if (len < 0 || addr.nl_pid) {
 			syslog(LOG_ERR, "recvfrom failed; pid:%u error:%d %s",
 					addr.nl_pid, errno, strerror(errno));
 			close(fd);
 			return  1;
 		}
