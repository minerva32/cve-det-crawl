CVE Number : CVE-2007-6206
Commit Message : 
vfs: coredumping fix
Commit Details : 
fix: http://bugzilla.kernel.org/show_bug.cgi?id=3043

only allow coredumping to the same uid that the coredumping
task runs under.

Signed-off-by: Ingo Molnar <mingo@elte.hu>
Acked-by: Alan Cox <alan@redhat.com>
Acked-by: Christoph Hellwig <hch@lst.de>
Acked-by: Al Viro <viro@ftp.linux.org.uk>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 	   but keep the previous behaviour for now. */
 	if (!ispipe && !S_ISREG(inode >i_mode))
 		goto close_fail;
 	if (!file >f_op)
 		goto close_fail;
 	if (!file >f_op >write)
After patch : 
 	   but keep the previous behaviour for now. */
 	if (!ispipe && !S_ISREG(inode >i_mode))
 		goto close_fail;
 	/*
 	 * Dont allow local users get cute and trick others to coredump
 	 * into their pre created files:
 	 */
 	if (inode >i_uid != current >fsuid)
 		goto close_fail;
 	if (!file >f_op)
 		goto close_fail;
 	if (!file >f_op >write)
