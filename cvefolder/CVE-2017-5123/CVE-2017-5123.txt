CVE Number : CVE-2017-5123
Commit Message : 
waitid(): Add missing access_ok() checks
Commit Details : 
Adds missing access_ok() checks.

CVE-2017-5123

Reported-by: Chris Salls <chrissalls5@gmail.com>
Signed-off-by: Kees Cook <keescook@chromium.org>
Acked-by: Al Viro <viro@zeniv.linux.org.uk>
Fixes: 4c48abe91be0 ("waitid(): switch copyout of siginfo to unsafe_put_user()")
Cc: stable@kernel.org # 4.13
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 	if (!infop)
 		return err;
 
 	user_access_begin();
 	unsafe_put_user(signo, &infop >si_signo, Efault);
 	unsafe_put_user(0, &infop >si_errno, Efault);
 	if (!infop)
 		return err;
 
 	user_access_begin();
 	unsafe_put_user(signo, &infop >si_signo, Efault);
 	unsafe_put_user(0, &infop >si_errno, Efault);
After patch : 
 	if (!infop)
 		return err;
 
 	if (!access_ok(VERIFY_WRITE, infop, sizeof(*infop)))
 		goto Efault;
 
 	user_access_begin();
 	unsafe_put_user(signo, &infop >si_signo, Efault);
 	unsafe_put_user(0, &infop >si_errno, Efault);
 	if (!infop)
 		return err;
 
 	if (!access_ok(VERIFY_WRITE, infop, sizeof(*infop)))
 		goto Efault;
 
 	user_access_begin();
 	unsafe_put_user(signo, &infop >si_signo, Efault);
 	unsafe_put_user(0, &infop >si_errno, Efault);
