CVE Number : CVE-2014-9584
Commit Message : 
isofs: Fix unchecked printing of ER records
Commit Details : 
We didn't check length of rock ridge ER records before printing them.
Thus corrupted isofs image can cause us to access and print some memory
behind the buffer with obvious consequences.

Reported-and-tested-by: Carl Henrik Lunde <chlunde@ping.uio.no>
CC: stable@vger.kernel.org
Signed-off-by: Jan Kara <jack@suse.cz>

Before patch : 
 			rs.cont_size = isonum_733(rr >u.CE.size);
 			break;
 		case SIG('E', 'R'):
 			ISOFS_SB(inode >i_sb) >s_rock = 1;
 			printk(KERN_DEBUG "ISO 9660 Extensions: ");
 			{
After patch : 
 			rs.cont_size = isonum_733(rr >u.CE.size);
 			break;
 		case SIG('E', 'R'):
 			/* Invalid length of ER tag id? */
 			if (rr >u.ER.len_id   offsetof(struct rock_ridge, u.ER.data) > rr >len)
 				goto out;
 			ISOFS_SB(inode >i_sb) >s_rock = 1;
 			printk(KERN_DEBUG "ISO 9660 Extensions: ");
 			{
