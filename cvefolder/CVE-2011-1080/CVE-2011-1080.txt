CVE Number : CVE-2011-1080
Commit Message : 
bridge: netfilter: fix information leak
Commit Details : 
Struct tmp is copied from userspace.  It is not checked whether the "name"
field is NULL terminated.  This may lead to buffer overflow and passing
contents of kernel stack as a module name to try_then_request_module() and,
consequently, to modprobe commandline.  It would be seen by all userspace
processes.

Signed-off-by: Vasiliy Kulikov <segoon@openwall.com>
Signed-off-by: Patrick McHardy <kaber@trash.net>

Before patch : 
 	if (tmp.num_counters >= INT_MAX / sizeof(struct ebt_counter))
 		return  ENOMEM;
 
 	countersize = COUNTER_OFFSET(tmp.nentries) * nr_cpu_ids;
 	newinfo = vmalloc(sizeof(*newinfo)   countersize);
 	if (!newinfo)
After patch : 
 	if (tmp.num_counters >= INT_MAX / sizeof(struct ebt_counter))
 		return  ENOMEM;
 
 	tmp.name[sizeof(tmp.name)   1] = 0;
 
 	countersize = COUNTER_OFFSET(tmp.nentries) * nr_cpu_ids;
 	newinfo = vmalloc(sizeof(*newinfo)   countersize);
 	if (!newinfo)
