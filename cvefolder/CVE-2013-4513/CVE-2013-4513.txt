CVE Number : CVE-2013-4513
Commit Message : 
staging: ozwpan: prevent overflow in oz_cdev_write()
Commit Details : 
We need to check "count" so we don't overflow the ei->data buffer.

Reported-by: Nico Golde <nico@ngolde.de>
Reported-by: Fabian Yamaguchi <fabs@goesec.de>
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Cc: stable@kernel.org
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 	struct oz_app_hdr *app_hdr;
 	struct oz_serial_ctx *ctx;
 
 	spin_lock_bh(&g_cdev.lock);
 	pd = g_cdev.active_pd;
 	if (pd)
After patch : 
 	struct oz_app_hdr *app_hdr;
 	struct oz_serial_ctx *ctx;
 
 	if (count > sizeof(ei >data)   sizeof(*elt)   sizeof(*app_hdr))
 		return  EINVAL;
 
 	spin_lock_bh(&g_cdev.lock);
 	pd = g_cdev.active_pd;
 	if (pd)
