CVE Number : CVE-2014-9420
Commit Message : 
isofs: Fix infinite looping over CE entries
Commit Details : 
Rock Ridge extensions define so called Continuation Entries (CE) which
define where is further space with Rock Ridge data. Corrupted isofs
image can contain arbitrarily long chain of these, including a one
containing loop and thus causing kernel to end in an infinite loop when
traversing these entries.

Limit the traversal to 32 entries which should be more than enough space
to store all the Rock Ridge data.

Reported-by: P J P <ppandit@redhat.com>
CC: stable@vger.kernel.org
Signed-off-by: Jan Kara <jack@suse.cz>

Before patch : 
 	int cont_size;
 	int cont_extent;
 	int cont_offset;
 	struct inode *inode;
 };
 
 	rs >inode = inode;
 }
 
 /*
  * Returns 0 if the caller should continue scanning, 1 if the scan must end
  * and  ve on error.
 			goto out;
 		}
 		ret =  EIO;
 		bh = sb_bread(rs >inode >i_sb, rs >cont_extent);
 		if (bh) {
 			memcpy(rs >buffer, bh >b_data   rs >cont_offset,
After patch : 
 	int cont_size;
 	int cont_extent;
 	int cont_offset;
 	int cont_loops;
 	struct inode *inode;
 };
 
 	rs >inode = inode;
 }
 
 /* Maximum number of Rock Ridge continuation entries */
 #define RR_MAX_CE_ENTRIES 32
 
 /*
  * Returns 0 if the caller should continue scanning, 1 if the scan must end
  * and  ve on error.
 			goto out;
 		}
 		ret =  EIO;
 		if (  rs >cont_loops >= RR_MAX_CE_ENTRIES)
 			goto out;
 		bh = sb_bread(rs >inode >i_sb, rs >cont_extent);
 		if (bh) {
 			memcpy(rs >buffer, bh >b_data   rs >cont_offset,
