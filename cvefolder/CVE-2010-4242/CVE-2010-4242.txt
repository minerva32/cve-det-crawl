CVE Number : CVE-2010-4242
Commit Message : 
bluetooth: Fix missing NULL check
Commit Details : 
Fortunately this is only exploitable on very unusual hardware.

Reported a while ago but nothing happened so just fixing it

Signed-off-by: Alan Cox <alan@linux.intel.com>
Cc: stable@kernel.org
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 
 	BT_DBG("tty %p", tty);
 
 	if (hu)
 		return  EEXIST;
 
 	if (!(hu = kzalloc(sizeof(struct hci_uart), GFP_KERNEL))) {
 		BT_ERR("Can't allocate control structure");
 		return  ENFILE;
After patch : 
 
 	BT_DBG("tty %p", tty);
 
 	/* FIXME: This btw is bogus, nothing requires the old ldisc to clear
 	   the pointer */
 	if (hu)
 		return  EEXIST;
 
 	/* Error if the tty has no write op instead of leaving an exploitable
 	   hole */
 	if (tty >ops >write == NULL)
 		return  EOPNOTSUPP;
 
 	if (!(hu = kzalloc(sizeof(struct hci_uart), GFP_KERNEL))) {
 		BT_ERR("Can't allocate control structure");
 		return  ENFILE;
