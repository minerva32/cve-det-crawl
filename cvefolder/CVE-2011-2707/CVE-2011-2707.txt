CVE Number : CVE-2011-2707
Commit Message : 
xtensa: prevent arbitrary read in ptrace
Commit Details : 
Prevent an arbitrary kernel read.  Check the user pointer with access_ok()
before copying data in.

akpm@linux-foundation.org: s/EIO/EFAULT/
Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com>
Cc: Christian Zankel <chris@zankel.net>
Cc: Oleg Nesterov <oleg@redhat.com>
Cc: <stable@kernel.org>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 	elf_xtregs_t *xtregs = uregs;
 	int ret = 0;
 
 #if XTENSA_HAVE_COPROCESSORS
 	/* Flush all coprocessors before we overwrite them. */
 	coprocessor_flush_all(ti);
After patch : 
 	elf_xtregs_t *xtregs = uregs;
 	int ret = 0;
 
 	if (!access_ok(VERIFY_READ, uregs, sizeof(elf_xtregs_t)))
 		return  EFAULT;
 
 #if XTENSA_HAVE_COPROCESSORS
 	/* Flush all coprocessors before we overwrite them. */
 	coprocessor_flush_all(ti);
