CVE Number : CVE-2019-20810
Commit Message : 
media: go7007: fix a miss of snd_card_free
Commit Details : 
go7007_snd_init() misses a snd_card_free() in an error path.
Add the missed call to fix it.

Signed-off-by: Chuhong Yuan <hslester96@gmail.com>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

Before patch : 
 	gosnd >capturing = 0;
 	ret = snd_card_new(go >dev, index[dev], id[dev], THIS_MODULE, 0,
 			   &gosnd >card);
 	if (ret < 0) {
 		kfree(gosnd);
 		return ret;
 	}
 	ret = snd_device_new(gosnd >card, SNDRV_DEV_LOWLEVEL, go,
 			&go7007_snd_device_ops);
 	if (ret < 0) {
 		kfree(gosnd);
 		return ret;
 	}
 	ret = snd_pcm_new(gosnd >card, "go7007", 0, 0, 1, &gosnd >pcm);
 	if (ret < 0) {
 		snd_card_free(gosnd >card);
 		kfree(gosnd);
 		return ret;
 	}
 	strscpy(gosnd >card >driver, "go7007", sizeof(gosnd >card >driver));
 	strscpy(gosnd >card >shortname, go >name, sizeof(gosnd >card >shortname));
 	strscpy(gosnd >card >longname, gosnd >card >shortname,
 			&go7007_snd_capture_ops);
 
 	ret = snd_card_register(gosnd >card);
 	if (ret < 0) {
 		snd_card_free(gosnd >card);
 		kfree(gosnd);
 		return ret;
 	}
 
 	gosnd >substream = NULL;
 	go >snd_context = gosnd;
 	  dev;
 
 	return 0;
 }
 EXPORT_SYMBOL(go7007_snd_init);
 
After patch : 
 	gosnd >capturing = 0;
 	ret = snd_card_new(go >dev, index[dev], id[dev], THIS_MODULE, 0,
 			   &gosnd >card);
 	if (ret < 0)
 		goto free_snd;
 
 	ret = snd_device_new(gosnd >card, SNDRV_DEV_LOWLEVEL, go,
 			&go7007_snd_device_ops);
 	if (ret < 0)
 		goto free_card;
 
 	ret = snd_pcm_new(gosnd >card, "go7007", 0, 0, 1, &gosnd >pcm);
 	if (ret < 0)
 		goto free_card;
 
 	strscpy(gosnd >card >driver, "go7007", sizeof(gosnd >card >driver));
 	strscpy(gosnd >card >shortname, go >name, sizeof(gosnd >card >shortname));
 	strscpy(gosnd >card >longname, gosnd >card >shortname,
 			&go7007_snd_capture_ops);
 
 	ret = snd_card_register(gosnd >card);
 	if (ret < 0)
 		goto free_card;
 
 	gosnd >substream = NULL;
 	go >snd_context = gosnd;
 	  dev;
 
 	return 0;
 
 free_card:
 	snd_card_free(gosnd >card);
 free_snd:
 	kfree(gosnd);
 	return ret;
 }
 EXPORT_SYMBOL(go7007_snd_init);
 
