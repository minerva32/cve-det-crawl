CVE Number : CVE-2018-10938
Commit Message : 
Cipso: cipso_v4_optptr enter infinite loop
Commit Details : 
in for(),if((optlen > 0) && (optptr1 == 0)), enter infinite loop.

Test: receive a packet which the ip length > 20 and the first byte of ip option is 0, produce this issue

Signed-off-by: yujuan.qi <yujuan.qi@mediatek.com>
Acked-by: Paul Moore <paul@paul-moore.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	int taglen;
 
 	for (optlen = iph >ihl*4   sizeof(struct iphdr); optlen > 0; ) {
 		if (optptr[0] == IPOPT_CIPSO)
 			return optptr;
 		taglen = optptr[1];
 		optlen  = taglen;
 		optptr  = taglen;
 	}
After patch : 
 	int taglen;
 
 	for (optlen = iph >ihl*4   sizeof(struct iphdr); optlen > 0; ) {
 		switch (optptr[0]) {
 		case IPOPT_CIPSO:
 			return optptr;
 		case IPOPT_END:
 			return NULL;
 		case IPOPT_NOOP:
 			taglen = 1;
 			break;
 		default:
 			taglen = optptr[1];
 		}
 		optlen  = taglen;
 		optptr  = taglen;
 	}
