CVE Number : CVE-2016-3140
Commit Message : 
USB: digi_acceleport: do sanity checking for the number of ports
Commit Details : 
The driver can be crashed with devices that expose crafted descriptors
with too few endpoints.

See: http://seclists.org/bugtraq/2016/Mar/61

Signed-off-by: Oliver Neukum <ONeukum@suse.com>
johan: fix OOB endpoint check and add error messages 
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Johan Hovold <johan@kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

Before patch : 
 
 static int digi_startup(struct usb_serial *serial)
 {
 	struct digi_serial *serial_priv;
 	int ret;
 
 	serial_priv = kzalloc(sizeof(*serial_priv), GFP_KERNEL);
 	if (!serial_priv)
After patch : 
 
 static int digi_startup(struct usb_serial *serial)
 {
 	struct device *dev = &serial >interface >dev;
 	struct digi_serial *serial_priv;
 	int ret;
 	int i;
 
 	/* check whether the device has the expected number of endpoints */
 	if (serial >num_port_pointers < serial >type >num_ports   1) {
 		dev_err(dev, "OOB endpoints missing\n");
 		return  ENODEV;
 	}
 
 	for (i = 0; i < serial >type >num_ports   1 ; i  ) {
 		if (!serial >port[i] >read_urb) {
 			dev_err(dev, "bulk in endpoint missing\n");
 			return  ENODEV;
 		}
 		if (!serial >port[i] >write_urb) {
 			dev_err(dev, "bulk out endpoint missing\n");
 			return  ENODEV;
 		}
 	}
 
 	serial_priv = kzalloc(sizeof(*serial_priv), GFP_KERNEL);
 	if (!serial_priv)
