CVE Number : CVE-2011-2898
Commit Message : 
af_packet: prevent information leak
Commit Details : 
In 2.6.27, commit 393e52e33c6c2 (packet: deliver VLAN TCI to userspace)
added a small information leak.

Add padding field and make sure its zeroed before copy to user.

Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
CC: Patrick McHardy <kaber@trash.net>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	__u16		tp_mac;
 	__u16		tp_net;
 	__u16		tp_vlan_tci;
 };
 
 /* Rx ring   header status */
 	__u32		tp_sec;
 	__u32		tp_nsec;
 	__u16		tp_vlan_tci;
 };
 
 #define TPACKET2_HDRLEN		(TPACKET_ALIGN(sizeof(struct tpacket2_hdr))   sizeof(struct sockaddr_ll))
 		} else {
 			h.h2 >tp_vlan_tci = 0;
 		}
 		hdrlen = sizeof(*h.h2);
 		break;
 	default:
 		} else {
 			aux.tp_vlan_tci = 0;
 		}
 		put_cmsg(msg, SOL_PACKET, PACKET_AUXDATA, sizeof(aux), &aux);
 	}
 
After patch : 
 	__u16		tp_mac;
 	__u16		tp_net;
 	__u16		tp_vlan_tci;
 	__u16		tp_padding;
 };
 
 /* Rx ring   header status */
 	__u32		tp_sec;
 	__u32		tp_nsec;
 	__u16		tp_vlan_tci;
 	__u16		tp_padding;
 };
 
 #define TPACKET2_HDRLEN		(TPACKET_ALIGN(sizeof(struct tpacket2_hdr))   sizeof(struct sockaddr_ll))
 		} else {
 			h.h2 >tp_vlan_tci = 0;
 		}
 		h.h2 >tp_padding = 0;
 		hdrlen = sizeof(*h.h2);
 		break;
 	default:
 		} else {
 			aux.tp_vlan_tci = 0;
 		}
 		aux.tp_padding = 0;
 		put_cmsg(msg, SOL_PACKET, PACKET_AUXDATA, sizeof(aux), &aux);
 	}
 
