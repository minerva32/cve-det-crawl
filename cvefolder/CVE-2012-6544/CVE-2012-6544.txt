CVE Number : CVE-2012-6544
Commit Message : 
Bluetooth: L2CAP - Fix info leak via getsockname()
Commit Details : 
The L2CAP code fails to initialize the l2_bdaddr_type member of struct
sockaddr_l2 and the padding byte added for alignment. It that for leaks
two bytes kernel stack via the getsockname() syscall. Add an explicit
memset(0) before filling the structure to avoid the info leak.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Cc: Marcel Holtmann <marcel@holtmann.org>
Cc: Gustavo Padovan <gustavo@padovan.org>
Cc: Johan Hedberg <johan.hedberg@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 
 	BT_DBG("sock %p, sk %p", sock, sk);
 
 	addr >sa_family = AF_BLUETOOTH;
 	*len = sizeof(struct sockaddr_l2);
 
After patch : 
 
 	BT_DBG("sock %p, sk %p", sock, sk);
 
 	memset(la, 0, sizeof(struct sockaddr_l2));
 	addr >sa_family = AF_BLUETOOTH;
 	*len = sizeof(struct sockaddr_l2);
 
