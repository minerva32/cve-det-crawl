CVE Number : CVE-2021-41073
Commit Message : 
io_uring: ensure symmetry in handling iter types in loop_rw_iter()
Commit Details : 
When setting up the next segment, we check what type the iter is and
handle it accordingly. However, when incrementing and processed amount
we do not, and both iter advance and addr/len are adjusted, regardless
of type. Split the increment side just like we do on the setup side.

Fixes: 4017eb91a9e7 ("io_uring: make loop_rw_iter() use original user supplied pointers")
Cc: stable@vger.kernel.org
Reported-by: Valentina Palmiotti <vpalmiotti@gmail.com>
Reviewed-by: Pavel Begunkov <asml.silence@gmail.com>
Signed-off-by: Jens Axboe <axboe@kernel.dk>

Before patch : 
 				ret = nr;
 			break;
 		}
 		ret  = nr;
 		if (nr != iovec.iov_len)
 			break;
 		req >rw.len  = nr;
 		req >rw.addr  = nr;
 		iov_iter_advance(iter, nr);
 	}
 
 	return ret;
After patch : 
 				ret = nr;
 			break;
 		}
 		if (!iov_iter_is_bvec(iter)) {
 			iov_iter_advance(iter, nr);
 		} else {
 			req >rw.len  = nr;
 			req >rw.addr  = nr;
 		}
 		ret  = nr;
 		if (nr != iovec.iov_len)
 			break;
 	}
 
 	return ret;
