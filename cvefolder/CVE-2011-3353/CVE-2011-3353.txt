CVE Number : CVE-2011-3353
Commit Message : 
fuse: check size of FUSE_NOTIFY_INVAL_ENTRY message
Commit Details : 
FUSE_NOTIFY_INVAL_ENTRY didn't check the length of the write so the
message processing could overrun and result in a "kernel BUG at
fs/fuse/dev.c:629!"

Reported-by: Han-Wen Nienhuys <hanwenn@gmail.com>
Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>
CC: stable@kernel.org

Before patch : 
 	if (outarg.namelen > FUSE_NAME_MAX)
 		goto err;
 
 	name.name = buf;
 	name.len = outarg.namelen;
 	err = fuse_copy_one(cs, buf, outarg.namelen   1);
After patch : 
 	if (outarg.namelen > FUSE_NAME_MAX)
 		goto err;
 
 	err =  EINVAL;
 	if (size != sizeof(outarg)   outarg.namelen   1)
 		goto err;
 
 	name.name = buf;
 	name.len = outarg.namelen;
 	err = fuse_copy_one(cs, buf, outarg.namelen   1);
