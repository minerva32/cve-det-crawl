CVE Number : CVE-2013-3226
Commit Message : 
Bluetooth: SCO - Fix missing msg_namelen update in sco_sock_recvmsg()
Commit Details : 
If the socket is in state BT_CONNECT2 and BT_SK_DEFER_SETUP is set in
the flags, sco_sock_recvmsg() returns early with 0 without updating the
possibly set msg_namelen member. This, in turn, leads to a 128 byte
kernel stack leak in net/socket.c.

Fix this by updating msg_namelen in this case. For all other cases it
will be handled in bt_sock_recvmsg().

Cc: Marcel Holtmann <marcel@holtmann.org>
Cc: Gustavo Padovan <gustavo@padovan.org>
Cc: Johan Hedberg <johan.hedberg@gmail.com>
Signed-off-by: Mathias Krause <minipli@googlemail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 	    test_bit(BT_SK_DEFER_SETUP, &bt_sk(sk) >flags)) {
 		hci_conn_accept(pi >conn >hcon, 0);
 		sk >sk_state = BT_CONFIG;
 
 		release_sock(sk);
 		return 0;
After patch : 
 	    test_bit(BT_SK_DEFER_SETUP, &bt_sk(sk) >flags)) {
 		hci_conn_accept(pi >conn >hcon, 0);
 		sk >sk_state = BT_CONFIG;
 		msg >msg_namelen = 0;
 
 		release_sock(sk);
 		return 0;
