CVE Number : CVE-2005-4618
Commit Message : 
sysctl: don't overflow the user-supplied buffer with '\0'
Commit Details : 
If the string was too long to fit in the user-supplied buffer,
the sysctl layer would zero-terminate it by writing past the
end of the buffer. Don't do that.

Noticed by Yi Yang <yang.y.yi@gmail.com>

Signed-off-by: Linus Torvalds <torvalds@osdl.org>

Before patch : 
 		if (get_user(len, oldlenp))
 			return  EFAULT;
 		if (len) {
 			l = strlen(table >data);
 			if (len > l) len = l;
 			if (len >= table >maxlen)
 				len = table >maxlen;
 			if(copy_to_user(oldval, table >data, len))
 				return  EFAULT;
 			if(put_user(0, ((char __user *) oldval)   len))
 				return  EFAULT;
 			if(put_user(len, oldlenp))
 				return  EFAULT;
 		}
After patch : 
 		if (get_user(len, oldlenp))
 			return  EFAULT;
 		if (len) {
 			l = strlen(table >data) 1;
 			if (len > l) len = l;
 			if (len >= table >maxlen)
 				len = table >maxlen;
 			if(copy_to_user(oldval, table >data, len))
 				return  EFAULT;
 			if(put_user(len, oldlenp))
 				return  EFAULT;
 		}
