CVE Number : CVE-2015-4167
Commit Message : 
udf: Check length of extended attributes and allocation descriptors
Commit Details : 
Check length of extended attributes and allocation descriptors when
loading inodes from disk. Otherwise corrupted filesystems could confuse
the code and make the kernel oops.

Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no>
CC: stable@vger.kernel.org
Signed-off-by: Jan Kara <jack@suse.cz>

Before patch : 
 	}
 	inode >i_generation = iinfo >i_unique;
 
 	/* Sanity checks for files in ICB so that we don't get confused later */
 	if (iinfo >i_alloc_type == ICBTAG_FLAG_AD_IN_ICB) {
 		/*
After patch : 
 	}
 	inode >i_generation = iinfo >i_unique;
 
 	/*
 	 * Sanity check length of allocation descriptors and extended attrs to
 	 * avoid integer overflows
 	 */
 	if (iinfo >i_lenEAttr > bs || iinfo >i_lenAlloc > bs)
 		goto out;
 	/* Now do exact checks */
 	if (udf_file_entry_alloc_offset(inode)   iinfo >i_lenAlloc > bs)
 		goto out;
 	/* Sanity checks for files in ICB so that we don't get confused later */
 	if (iinfo >i_alloc_type == ICBTAG_FLAG_AD_IN_ICB) {
 		/*
