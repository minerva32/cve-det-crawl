CVE Number : CVE-2022-0617
Commit Message : 
udf: Restore i_lenAlloc when inode expansion fails
Commit Details : 
When we fail to expand inode from inline format to a normal format, we
restore inode to contain the original inline formatting but we forgot to
set i_lenAlloc back. The mismatch between i_lenAlloc and i_size was then
causing further problems such as warnings and lost data down the line.

Reported-by: butt3rflyh4ck <butterflyhuangxx@gmail.com>
CC: stable@vger.kernel.org
Fixes: 7e49b6f2480c ("udf: Convert UDF to new truncate calling sequence")
Reviewed-by: Christoph Hellwig <hch@lst.de>
Signed-off-by: Jan Kara <jack@suse.cz>

Before patch : 
 		unlock_page(page);
 		iinfo >i_alloc_type = ICBTAG_FLAG_AD_IN_ICB;
 		inode >i_data.a_ops = &udf_adinicb_aops;
 		up_write(&iinfo >i_data_sem);
 	}
 	put_page(page);
After patch : 
 		unlock_page(page);
 		iinfo >i_alloc_type = ICBTAG_FLAG_AD_IN_ICB;
 		inode >i_data.a_ops = &udf_adinicb_aops;
 		iinfo >i_lenAlloc = inode >i_size;
 		up_write(&iinfo >i_data_sem);
 	}
 	put_page(page);
