CVE Number : CVE-2009-3640
Commit Message : 
KVM: Protect update_cr8_intercept() when running without an apic
Commit Details : 
update_cr8_intercept() can be triggered from userspace while there
is no apic present.

Signed-off-by: Avi Kivity <avi@redhat.com>

Before patch : 
 	if (!kvm_x86_ops >update_cr8_intercept)
 		return;
 
 	if (!vcpu >arch.apic >vapic_addr)
 		max_irr = kvm_lapic_find_highest_irr(vcpu);
 	else
After patch : 
 	if (!kvm_x86_ops >update_cr8_intercept)
 		return;
 
 	if (!vcpu >arch.apic)
 		return;
 
 	if (!vcpu >arch.apic >vapic_addr)
 		max_irr = kvm_lapic_find_highest_irr(vcpu);
 	else
