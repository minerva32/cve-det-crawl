CVE Number : CVE-2020-36158
Commit Message : 
mwifiex: Fix possible buffer overflows in mwifiex_cmd_802_11_ad_hoc_start
Commit Details : 
mwifiex_cmd_802_11_ad_hoc_start() calls memcpy() without checking
the destination size may trigger a buffer overflower,
which a local user could use to cause denial of service
or the execution of arbitrary code.
Fix it by putting the length check before calling memcpy().

Signed-off-by: Zhang Xiaohui <ruc_zhangxiaohui@163.com>
Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
Link: https://lore.kernel.org/r/20201206084801.26479-1-ruc_zhangxiaohui@163.com

Before patch : 
 
 	memset(adhoc_start >ssid, 0, IEEE80211_MAX_SSID_LEN);
 
 	memcpy(adhoc_start >ssid, req_ssid >ssid, req_ssid >ssid_len);
 
 	mwifiex_dbg(adapter, INFO, "info: ADHOC_S_CMD: SSID = %s\n",
After patch : 
 
 	memset(adhoc_start >ssid, 0, IEEE80211_MAX_SSID_LEN);
 
 	if (req_ssid >ssid_len > IEEE80211_MAX_SSID_LEN)
 		req_ssid >ssid_len = IEEE80211_MAX_SSID_LEN;
 	memcpy(adhoc_start >ssid, req_ssid >ssid, req_ssid >ssid_len);
 
 	mwifiex_dbg(adapter, INFO, "info: ADHOC_S_CMD: SSID = %s\n",
