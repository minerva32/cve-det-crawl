CVE Number : CVE-2009-3613
Commit Message : 
r8169: use hardware auto-padding.
Commit Details : 
It shortens the code and fixes the current pci_unmap leak with
padded skb reported by Dave Jones.

Signed-off-by: Francois Romieu <romieu@fr.zoreil.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Before patch : 
 		opts1 |= FirstFrag;
 	} else {
 		len = skb >len;
 
 		if (unlikely(len < ETH_ZLEN)) {
 			if (skb_padto(skb, ETH_ZLEN))
 				goto err_update_stats;
 			len = ETH_ZLEN;
 		}
 
 		opts1 |= FirstFrag | LastFrag;
 		tp >tx_skb[entry].skb = skb;
 	}
 err_stop:
 	netif_stop_queue(dev);
 	ret = NETDEV_TX_BUSY;
 err_update_stats:
 	dev >stats.tx_dropped  ;
 	goto out;
 }
After patch : 
 		opts1 |= FirstFrag;
 	} else {
 		len = skb >len;
 		opts1 |= FirstFrag | LastFrag;
 		tp >tx_skb[entry].skb = skb;
 	}
 err_stop:
 	netif_stop_queue(dev);
 	ret = NETDEV_TX_BUSY;
 	dev >stats.tx_dropped  ;
 	goto out;
 }
