CVE Number : CVE-2012-2384
Commit Message : 
drm/i915: fix integer overflow in i915_gem_do_execbuffer()
Commit Details : 
On 32-bit systems, a large args->num_cliprects from userspace via ioctl
may overflow the allocation size, leading to out-of-bounds access.

This vulnerability was introduced in commit 432e58ed ("drm/i915: Avoid
allocation for execbuffer object list").

Signed-off-by: Xi Wang <xi.wang@gmail.com>
Reviewed-by: Chris Wilson <chris@chris-wilson.co.uk>
Cc: stable@vger.kernel.org
Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

Before patch : 
 			return  EINVAL;
 		}
 
 		cliprects = kmalloc(args >num_cliprects * sizeof(*cliprects),
 				    GFP_KERNEL);
 		if (cliprects == NULL) {
After patch : 
 			return  EINVAL;
 		}
 
 		if (args >num_cliprects > UINT_MAX / sizeof(*cliprects)) {
 			DRM_DEBUG("execbuf with %u cliprects\n",
 				  args >num_cliprects);
 			return  EINVAL;
 		}
 		cliprects = kmalloc(args >num_cliprects * sizeof(*cliprects),
 				    GFP_KERNEL);
 		if (cliprects == NULL) {
