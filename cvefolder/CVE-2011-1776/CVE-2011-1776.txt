CVE Number : CVE-2011-1776
Commit Message : 
Validate size of EFI GUID partition entries.
Commit Details : 
Otherwise corrupted EFI partition tables can cause total confusion.

Signed-off-by: Timo Warns <warns@pre-sense.de>
Cc: stable@kernel.org
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Before patch : 
 		goto fail;
 	}
 
 	if (!(*ptes = alloc_read_gpt_entries(state, *gpt)))
 		goto fail;
 
After patch : 
 		goto fail;
 	}
 
 	/* Check that sizeof_partition_entry has the correct value */
 	if (le32_to_cpu((*gpt) >sizeof_partition_entry) != sizeof(gpt_entry)) {
 		pr_debug("GUID Partitition Entry Size check failed.\n");
 		goto fail;
 	}
 
 	if (!(*ptes = alloc_read_gpt_entries(state, *gpt)))
 		goto fail;
 
